# ç½‘ç»œè¿æ¥è¿‡ç¨‹

> OSI: 7å±‚æ¨¡å‹ï¼Œä»ä¸Šåˆ°ä¸‹

- åº”ç”¨å±‚ï¼šä¸ºåº”ç”¨ç¨‹åºæä¾›æœåŠ¡
- è¡¨ç¤ºå±‚ï¼šæ•°æ®æ ¼å¼åŒ–ï¼Œæ•°æ®åŠ å¯†
- ä¼šè¯å±‚ï¼šå»ºç«‹ï¼Œç®¡ç†å’Œç»´æŠ¤å›è¯
- ä¼ è¾“å±‚ï¼šå»ºè®¾ã€ç®¡ç†å’Œç»´æŠ¤ç«¯åˆ°ç«¯çš„ğŸ”—
- ç½‘ç»œå±‚ï¼šIPé€‰å€å’Œè·¯ç”±é€‰æ‹©
- æ•°æ®é“¾è·¯å±‚ï¼šæä¾›è®¿é—®ä»‹è´¨å’Œé“¾è·¯ç®¡ç†
- ç‰©ç†å±‚ï¼šç‰©ç†å±‚

> TCP/IP: 5å±‚æ¨¡å‹

- åº”ç”¨å±‚ï¼šTELENET, SSH, HTTP, SMTP, POP, SSL/TLS, FTP, MIME, HTML, SNMP, MIB, SIP, RTP
- ä¼ è¾“å±‚ï¼šTCP,UDP
- ç½‘ç»œå±‚ï¼šäº¤æ¢æœºï¼ˆIP,ICMP,RIP,IGMPï¼‰
- æ•°æ®é“¾è·¯å±‚ï¼šç½‘å¡
- ç‰©ç†å±‚ï¼šé›†çº¿å™¨ï¼Œä¸­é›†çº¿ï¼ŒåŒç»çº¿

> TELENETä¸SSHåè®®éƒ½æ˜¯å®¢æˆ·ç«¯è¿æ¥ç»ˆç«¯çš„åè®®ï¼ŒSSHåŠ å¯†ï¼ŒTELENETä¸åŠ å¯†.

## å…³é”®å­—

- å­ç½‘
- å­ç½‘æ©ç 
- ä¸»æœºå·
- IP
- ç½‘æ®µ
- MACåœ°å€
- tcpè¿æ¥ä¸‰æ¬¡æ¡æ‰‹
- é›†çº¿å™¨
- äº¤æ¢æœº
- è·¯ç”±å™¨

## æµè§ˆå™¨ç”Ÿæˆçš„æ¶ˆæ¯

### æµè§ˆå™¨ç”Ÿæˆ HTTP è¯·æ±‚æ¶ˆæ¯

- æµè§ˆå™¨å…ˆè¦è§£æ URL
- æ–‡ä»¶è·¯å¾„
- HTTP åŸºæœ¬åŸç†
  - è¯·æ±‚æ–¹æ³•
  - è¯·æ±‚å¤´å­—æ®µ
  - å“åº”çŠ¶æ€ç 

### å‘ DNS æœåŠ¡å™¨æŸ¥è¯¢ Web æœåŠ¡å™¨çš„ IP åœ°å€

- ipåœ°å€
  - å­ç½‘
  - ä¸»æœºå·
  - å­ç½‘æ©ç 
- Socket åº“æä¾›æŸ¥è¯¢ IP åœ°å€çš„åŠŸèƒ½ï¼ˆSocket åº“æ˜¯ç”¨äºè°ƒç”¨ç½‘ç»œåŠŸèƒ½çš„ç¨‹åºç»„ä»¶é›†åˆï¼‰
  - webæµè§ˆå™¨è°ƒç”¨æ“ä½œç³»ç»Ÿåº“socketåº“
  - é€šè¿‡è§£æå™¨å‘ DNS æœåŠ¡å™¨å‘å‡ºæŸ¥è¯¢

#### DNS æŸ¥è¯¢

- åŸŸåå±‚çº§
- DNSæœåŠ¡å™¨å±‚çº§
- DNSç¼“å­˜åŠ é€Ÿ

#### å§”æ‰˜åè®®æ ˆå‘é€æ¶ˆæ¯

- åˆ›å»ºå¥—æ¥å­—(åˆ›å»ºå¥—æ¥å­—é˜¶æ®µ)
- å°†ç®¡é“è¿æ¥åˆ°æœåŠ¡å™¨ç«¯çš„å¥—æ¥å­—ä¸Š(è¿æ¥é˜¶æ®µ)
- æ”¶å‘æ•°æ®(é€šä¿¡é˜¶æ®µ)
- æ–­å¼€ç®¡é“å¹¶åˆ é™¤å¥—æ¥å­—(æ–­å¼€é˜¶æ®µ)

### http

#### å¤´ä¸­çš„é‡è¦å­—æ®µ

| å¤´å­—æ®µç±»å‹ | Httpç‰ˆæœ¬ | å«ä¹‰ |
| - | - | - |
| é€šç”¨å¤´:é€‚ç”¨äºè¯·æ±‚å’Œå“åº”æ¶ˆæ¯çš„å¤´å­—æ®µ |
| Date | http1.0/http1.1 | è¡¨ç¤ºè¯·æ±‚å’Œå“åº”ç”Ÿæˆçš„æ—¥æœŸ|
| Pragma | http1.0/http1.1 | è¡¨ç¤ºæ•°æ®æ˜¯å¦å…è®¸ç¼“å­˜çš„é€šä¿¡é€‰é¡¹ |
| Cache-Control | http1.1 | æ§åˆ¶ç¼“å­˜çš„ç›¸å…³ä¿¡æ¯ |
| Connection | http1.1 | è®¾ç½®å‘é€å“åº”ä¹‹å TCP è¿æ¥æ˜¯å¦ç»§ç»­ä¿æŒçš„é€šä¿¡é€‰é¡¹ |
| Transfer-Encoding | http1.1 | è¡¨ç¤ºæ¶ˆæ¯ä¸»ä½“çš„ç¼–ç æ ¼å¼ |
| Via | http1.1 | è®°å½•é€”ä¸­ç»è¿‡çš„ä»£ç†å’Œç½‘å…³ |
| è¯·æ±‚å¤´:ç”¨äºè¡¨ç¤ºè¯·æ±‚æ¶ˆæ¯çš„é™„åŠ ä¿¡æ¯çš„å¤´å­—æ®µ |
| Authorization | http1.0/http1.1 | èº«ä»½è®¤è¯æ•°æ® |
| From | http1.0/http1.1 | è¯·æ±‚å‘é€è€…çš„é‚®ä»¶åœ°å€ |
| If-Modified-Since | http1.0/http1.1 | å¤„ç†ç¼“å­˜å­—æ®µï¼šå¦‚æœå¸Œæœ›ä»…å½“æ•°æ®åœ¨æŸä¸ªæ—¥æœŸä¹‹åæœ‰æ›´æ–°æ—¶æ‰æ‰§ è¡Œè¯·æ±‚ï¼Œå¯ä»¥åœ¨è¿™ä¸ªå­—æ®µæŒ‡å®šå¸Œæœ›çš„æ—¥æœŸã€‚ |
| Referer | http1.0/http1.1 | å½“é€šè¿‡ç‚¹å‡»è¶…çº§é“¾æ¥è¿›å…¥ä¸‹ä¸€ä¸ªé¡µé¢æ—¶ï¼Œåœ¨è¿™é‡Œä¼šè®°å½•ä¸‹ä¸Šä¸€ä¸ªé¡µé¢çš„ URI |
| User-Agent | http1.0/http1.1 | å®¢æˆ·ç«¯è½¯ä»¶çš„åç§°å’Œç‰ˆæœ¬å·ç­‰ç›¸å…³ä¿¡æ¯ |
| Accept | http1.0/http1.1 | å®¢æˆ·ç«¯å¯æ”¯æŒçš„æ•°æ®ç±»å‹(Content-Type)ï¼Œä»¥ MIME ç±»å‹æ¥è¡¨ç¤º |
| Accept-Charset | http1.0/http1.1 | å®¢æˆ·ç«¯å¯æ”¯æŒçš„å­—ç¬¦é›† |
| Accept-Encoding | http1.0/http1.1 | å®¢æˆ·ç«¯å¯æ”¯æŒçš„ç¼–ç æ ¼å¼(Content-Encoding)ï¼Œ ä¸€èˆ¬æ¥è¯´è¡¨ç¤ºæ•°æ®çš„å‹ç¼©æ ¼å¼ |
| Accept-Language | http1.0/http1.1 | å®¢æˆ·ç«¯å¯æ”¯æŒçš„è¯­è¨€ï¼Œæ±‰è¯­ä¸º zhï¼Œè‹±è¯­ä¸º en |
| Host | http1.1 | æ¥æ”¶è¯·æ±‚çš„æœåŠ¡å™¨ IP åœ°å€å’Œç«¯å£å· |
| If-Match | http1.1 | å‚è§ Etag |
| If-None-Match | http1.1 | å‚è§ Etag |
| If-Unmodified-Since | http1.1 | å½“æŒ‡å®šæ—¥æœŸä¹‹åæ•°æ®æœªæ›´æ–°æ—¶æ‰§è¡Œè¯·æ±‚ |
| Range | http1.1 | å½“éœ€è¦åªè·å–éƒ¨åˆ†æ•°æ®è€Œä¸æ˜¯å…¨éƒ¨æ•°æ®æ—¶ï¼Œå¯é€šè¿‡è¿™ä¸ªå­—æ®µæŒ‡å®šè¦è·å–çš„æ•°æ®èŒƒå›´ |
| å“åº”å¤´:ç”¨äºè¡¨ç¤ºå“åº”æ¶ˆæ¯çš„é™„åŠ ä¿¡æ¯çš„å¤´å­—æ®µ |
| Location | http1.0/http1.1 | è¡¨ç¤ºä¿¡æ¯çš„å‡†ç¡®ä½ç½®ã€‚å½“è¯·æ±‚çš„ URI ä¸ºç›¸å¯¹è·¯å¾„ æ—¶ï¼Œè¿™ä¸ªå­—æ®µç”¨æ¥è¿”å›ç»å¯¹è·¯å¾„ |
| Server | http1.0/http1.1 | æœåŠ¡å™¨ç¨‹åºçš„åç§°å’Œç‰ˆæœ¬å·ç­‰ç›¸å…³ä¿¡æ¯ |
| WWW-Authenticate | http1.0/http1.1 | å½“è¯·æ±‚çš„ä¿¡æ¯å­˜åœ¨è®¿é—®æ§åˆ¶æ—¶ï¼Œè¿”å›èº«ä»½è®¤è¯ç”¨çš„æ•°æ®(Challenge 1) |
| Accept-Ranges | http1.1 | å½“å¸Œæœ›ä»…è¯·æ±‚éƒ¨åˆ†æ•°æ®(ä½¿ç”¨ Range æ¥æŒ‡å®šèŒƒå›´) æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå‘ŠçŸ¥å®¢æˆ·ç«¯æ˜¯å¦æ”¯æŒè¿™ä¸€åŠŸèƒ½ |
| å®ä½“å¤´:ç”¨äºè¡¨ç¤ºå®ä½“(æ¶ˆæ¯ä½“)çš„é™„åŠ ä¿¡æ¯çš„å¤´å­—æ®µ |
| Allow | http1.0/http1.1 | è¡¨ç¤ºæŒ‡å®šçš„ URI æ”¯æŒçš„æ–¹æ³• |
| Content-Encoding | http1.0/http1.1 | å½“æ¶ˆæ¯ä½“ç»è¿‡å‹ç¼©ç­‰ç¼–ç å¤„ç†æ—¶ï¼Œè¡¨ç¤ºå…¶ç¼–ç æ ¼å¼ |
| Content-Length | http1.0/http1.1 | è¡¨ç¤ºæ¶ˆæ¯ä½“çš„é•¿åº¦ |
| Content-Type | http1.0/http1.1 | è¡¨ç¤ºæ¶ˆæ¯ä½“çš„æ•°æ®ç±»å‹ï¼Œä»¥ MIME è§„æ ¼å®šä¹‰çš„æ•° æ®ç±»å‹æ¥è¡¨ç¤º |
| Expires | http1.0/http1.1 | è¡¨ç¤ºæ¶ˆæ¯ä½“çš„æœ‰æ•ˆæœŸ |
| Last-Modified | http1.0/http1.1 | æ•°æ®çš„æœ€åæ›´æ–°æ—¥æœŸ |
| Content-Language | http1.0/http1.1 | è¡¨ç¤ºæ¶ˆæ¯ä½“çš„è¯­è¨€ã€‚æ±‰è¯­ä¸º zhï¼Œè‹±è¯­ä¸º en |
| Content-Location | http1.1 | è¡¨ç¤ºæ¶ˆæ¯ä½“åœ¨æœåŠ¡å™¨ä¸Šçš„ä½ç½®(URI) |
| Content-Range | http1.1 | å½“ä»…è¯·æ±‚éƒ¨åˆ†æ•°æ®æ—¶ï¼Œè¡¨ç¤ºæ¶ˆæ¯ä½“åŒ…å«çš„æ•°æ®èŒƒå›´ |
| Etag | http1.1 | åœ¨æ›´æ–°æ“ä½œä¸­ï¼Œæœ‰æ—¶å€™éœ€è¦åŸºäºä¸Šä¸€æ¬¡è¯·æ±‚çš„å“åº” æ•°æ®æ¥å‘é€ä¸‹ä¸€æ¬¡è¯·æ±‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå­—æ®µ å¯ä»¥ç”¨æ¥æä¾›ä¸Šæ¬¡å“åº”ä¸ä¸‹æ¬¡è¯·æ±‚ä¹‹é—´çš„å…³è”ä¿¡æ¯ã€‚ ä¸Šæ¬¡å“åº”ä¸­ï¼ŒæœåŠ¡å™¨ä¼šé€šè¿‡ Etag å‘å®¢æˆ·ç«¯å‘é€ä¸€ ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œåœ¨ä¸‹æ¬¡è¯·æ±‚ä¸­å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ If- Matchã€If-None-Matchã€If-Range å­—æ®µå°†è¿™ä¸ªæ ‡è¯† å‘ŠçŸ¥æœåŠ¡å™¨ï¼Œè¿™æ ·æœåŠ¡å™¨å°±çŸ¥é“è¯¥è¯·æ±‚å’Œä¸Šæ¬¡çš„å“ åº”æ˜¯ç›¸å…³çš„ã€‚è¿™ä¸ªå­—æ®µçš„åŠŸèƒ½å’Œ Cookie æ˜¯ç›¸åŒçš„ï¼Œ ä½† Cookie æ˜¯ç½‘æ™¯(Netscape)å…¬å¸è‡ªè¡Œå¼€å‘çš„è§„æ ¼ï¼Œ è€Œ Etag æ˜¯å°†å…¶è¿›è¡Œæ ‡å‡†åŒ–åçš„è§„æ ¼ |

#### HTTPçŠ¶æ€ç 

| çŠ¶æ€ç  | å«ä¹‰ |
| 1xx | å‘ŠçŸ¥è¯·æ±‚çš„å¤„ç†è¿›åº¦å’Œæƒ…å†µ |
| 2xx | æˆåŠŸ |
| 3xx | è¡¨ç¤ºéœ€è¦è¿›ä¸€æ­¥æ“ä½œ |
| 4xx | å®¢æˆ·ç«¯é”™è¯¯ |
| 5xx | æœåŠ¡å™¨é”™è¯¯ |

### DNS

### ipåœ°å€

- TCP/IP çš„ç»“æ„
![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/M2OEc8.png)

TCP/IP ç»“æ„å¯ä»¥ç†è§£ä¸ºç”±ä¸€äº›å°çš„å­ç½‘ï¼Œé€šè¿‡è·¯ç”±å™¨è¿æ¥èµ·æ¥çš„ä¸€ä¸ªå¤§ç½‘ç»œã€‚å­ç½‘å¯ä»¥ç†è§£ä¸ºç”¨é›†çº¿å™¨è¿æ¥èµ·æ¥çš„è®¡ç®—æœºã€‚å¯ä»¥å°†å…¶çœ‹æˆä¸€ä¸ªå•ä½ï¼Œç§°ä¸ºå­ç½‘ã€‚å°†å­ç½‘é€šè¿‡è·¯ç”±å™¨è¿æ¥èµ·æ¥ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªç½‘ç»œã€‚

- è·¯ç”±å™¨ï¼šä¸€ç§å¯¹åŒ…è¿›è¡Œè½¬å‘çš„è®¾å¤‡ï¼Œåœ¨ç¬¬ 3 ç« æœ‰è¯¦ç»†ä»‹ç»
- é›†çº¿å™¨ï¼šä¸€ç§å¯¹åŒ…è¿›è¡Œè½¬å‘çš„è®¾å¤‡ï¼Œåˆ†ä¸ºä¸­ç»§å¼é›†çº¿å™¨å’Œäº¤æ¢å¼é›†çº¿å™¨ä¸¤ç§

1. ipåœ°å€ä¸»ä½“è¡¨ç¤ºæ–¹å¼ï¼š`10.11.12.13`
2. é‡‡ç”¨ipåœ°å€ä¸»ä½“ç›¸åŒçš„æ ¼å¼è¡¨ç¤ºå­ç½‘æ©ç çš„æ–¹æ³•ï¼š`10.11.12.13/255.255.255.0`
3. é‡‡ç”¨ç½‘ç»œå·æ¯”ç‰¹æ•°æ¥è¡¨ç¤ºå­ç½‘æ©ç çš„æ–¹æ³•ï¼š`10.11.12.13/24`
4. è¡¨ç¤ºå­ç½‘çš„åœ°å€ï¼š`10.11.12.0/24`
5. è¡¨ç¤ºå­ç½‘å†…å¹¿æ’­çš„åœ°å€ï¼š`10.11.12.255/24`

| - | åè¿›åˆ¶è¡¨ç¤º | å°†å·¦ä¾§åè¿›åˆ¶è½¬æ¢æˆä¸ºæ¯”ç‰¹ |
| - | - | - |
| IPåœ°å€ | 10.1.2.3 | 00001010.00000001.00000010.00000011 |
| å­ç½‘æ©ç  | 255.255.255.0 | 11111111.11111111.11111111.00000000 |
| ç½‘ç»œå·/ä¸»æœºå· | 10.1.2/3 | 00001010.00000001.00000010/00000011 |

:::tip
IP åœ°å€çš„ä¸»æœºå·
å…¨ 0:è¡¨ç¤ºæ•´ä¸ªå­ç½‘
å…¨ 1:è¡¨ç¤ºå‘å­ç½‘ä¸Šæ‰€æœ‰è®¾å¤‡å‘é€åŒ…ï¼Œå³â€œå¹¿æ’­â€

### socketåº“ä¸dnsè§£æ

- Socket åº“æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„ä¸€ç§åº“ï¼Œå…¶ä¸­åŒ…å«çš„ç¨‹åºç»„ä»¶ï¼Œå¯ä»¥è®©å…¶ä»–çš„åº”ç”¨ç¨‹åºè°ƒç”¨æ“ä½œç³»ç»Ÿçš„ç½‘ç»œåŠŸèƒ½ã€‚è€Œè§£æå™¨å°±æ˜¯è¿™ä¸ªåº“ä¸­ çš„å…¶ä¸­ä¸€ç§ç¨‹åºç»„ä»¶ã€‚Socket åº“æ˜¯ç”¨äºè°ƒç”¨ç½‘ç»œåŠŸèƒ½çš„ç¨‹åºç»„ä»¶é›†åˆã€‚
- åœ¨ç¼–å†™æµè§ˆå™¨ç­‰åº”ç”¨ç¨‹åºçš„æ—¶å€™åªéœ€è¦ã€‚å†™ä¸Šè§£æå™¨çš„ç¨‹åºåç§°â€œgethostbynameâ€ä»¥åŠ Web æœåŠ¡å™¨ Bçš„åŸŸåâ€œwww.xxx.comâ€å°±å¯ä»¥äº†ï¼Œè¿™æ ·å°±å®Œæˆäº†å¯¹è§£æå™¨çš„è°ƒç”¨.`gethostbyname("www.xxx.com")`ã€‚

- è§£æå™¨å†…éƒ¨åŸç†ï¼Œ

## ç”¨ç”µä¿¡å·ä¼ è¾“ TCP/IP æ•°æ®

### åè®®æ ˆ

- åˆ›å»ºå¥—æ¥å­—
- è¿æ¥æœåŠ¡å™¨
- æ”¶å‘æ•°æ®
- ä»æœåŠ¡å™¨æ–­å¼€è¿æ¥å¹¶åˆ é™¤å¥—æ¥å­—
- IP ä¸ä»¥å¤ªç½‘çš„åŒ…æ”¶å‘æ“ä½œ
- ç”¨ UDP åè®®æ”¶å‘æ•°æ®çš„æ“ä½œ

> æµç¨‹å›¾

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/rDFEHO.png)

1. æœ€ä¸Šé¢çš„éƒ¨åˆ†æ˜¯ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œæµè§ˆå™¨ã€ç”µå­é‚®ä»¶å®¢æˆ·ç«¯ã€Web æœåŠ¡å™¨ã€ç”µå­é‚®ä»¶æœåŠ¡å™¨ç­‰ç¨‹åº. å®ƒä»¬ä¼šå°†æ”¶å‘æ•°æ®ç­‰å·¥ä½œå§”æ´¾ç»™ä¸‹å±‚çš„éƒ¨åˆ†æ¥å®Œæˆã€‚ä¸åŒçš„åº”ç”¨ç¨‹åºæ”¶å‘çš„æ•°æ®å†…å®¹ä¸åŒï¼Œä½†æ”¶å‘æ•°æ®çš„æ“ä½œæ˜¯å…±é€šçš„ã€‚
  åº”ç”¨ç¨‹åºä¸‹é¢æ˜¯socketåº“

2. ä¸‹é¢å°±æ˜¯æ“ä½œç³»ç»Ÿå†…éƒ¨äº†ï¼Œå…¶ä¸­åŒ…æ‹¬åè®®æ ˆã€‚åè®®æ ˆçš„ä¸ŠåŠéƒ¨åˆ†æœ‰ ä¸¤å—ï¼Œåˆ†åˆ«æ˜¯è´Ÿè´£ç”¨ TCP åè®®æ”¶å‘æ•°æ®çš„éƒ¨åˆ†å’Œè´Ÿè´£ç”¨ UDP åè®®æ”¶å‘æ•° æ®çš„éƒ¨åˆ†ã€‚åƒæµè§ˆå™¨ã€é‚®ä»¶ç­‰ä¸€èˆ¬çš„åº”ç”¨ç¨‹åºéƒ½æ˜¯ä½¿ç”¨ TCP æ”¶å‘æ•°æ®çš„ï¼Œè€Œåƒ DNS æŸ¥è¯¢ ç­‰æ”¶å‘è¾ƒçŸ­çš„æ§åˆ¶æ•°æ®çš„æ—¶å€™åˆ™ä½¿ç”¨ UDPã€‚

3. åœ¨äº’è”ç½‘ä¸Šä¼ é€æ•° æ®æ—¶ï¼Œæ•°æ®ä¼šè¢«åˆ‡åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„ç½‘ç»œåŒ…ï¼Œè€Œå°†ç½‘ç»œåŒ…å‘é€ç»™é€šä¿¡å¯¹è±¡çš„æ“ä½œå°±æ˜¯ç”± IP æ¥è´Ÿè´£çš„ï¼Œæ­¤å¤–ï¼ŒIP ä¸­è¿˜åŒ…æ‹¬ ICMPA åè®®å’Œ ARPB åè®®ã€‚ ICMP ç”¨äºå‘ŠçŸ¥ç½‘ç»œåŒ…ä¼ é€è¿‡ç¨‹ä¸­äº§ç”Ÿçš„é”™è¯¯ä»¥åŠå„ç§æ§åˆ¶æ¶ˆæ¯ï¼ŒARP ç”¨ äºæ ¹æ® IP åœ°å€æŸ¥è¯¢ç›¸åº”çš„ä»¥å¤ªç½‘ MAC åœ°å€

### å¥—æ¥å­—å®ä½“

å¥—æ¥å­—çš„å®ä½“å°±æ˜¯é€šä¿¡æ§åˆ¶ä¿¡æ¯ã€‚

- å­˜æ”¾æ§åˆ¶ä¿¡æ¯çš„å†…å­˜ç©ºé—´ï¼šé€šä¿¡å¯¹è±¡çš„ IP åœ°å€ã€ç«¯å£å·ã€é€šä¿¡æ“ä½œçš„ è¿›è¡ŒçŠ¶æ€ã€‚
- åœ¨å‘é€æ•°æ®æ—¶ï¼Œéœ€è¦çœ‹ä¸€çœ‹å¥—æ¥å­—ä¸­çš„é€šä¿¡å¯¹è±¡ IP åœ°å€å’Œç«¯å£å·ï¼Œä»¥ä¾¿å‘æŒ‡å®šçš„ IP åœ°å€ å’Œç«¯å£å‘é€æ•°æ®ã€‚ç­‰å¾…ä¸€å®šæ—¶é—´åå‘é€ä¸¢å¤±çš„æ•°æ®ã€‚
å¥—æ¥å­—ä¸­è®°å½•äº†ç”¨äºæ§åˆ¶é€šä¿¡æ“ä½œçš„å„ç§æ§åˆ¶ä¿¡æ¯ï¼Œåè®®æ ˆåˆ™éœ€è¦æ ¹æ®è¿™äº›ä¿¡æ¯åˆ¤æ–­ä¸‹ä¸€æ­¥çš„è¡ŒåŠ¨ï¼Œè¿™å°±æ˜¯å¥—æ¥ å­—çš„ä½œç”¨ã€‚

### è°ƒç”¨socketæ—¶çš„æ“ä½œ

æ¶ˆæ¯æ”¶å‘çš„æ“ä½œ

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/YuJPq1.png)

### è¿æ¥æœåŠ¡å™¨

- å½“æ‰§è¡Œæ•°æ®æ”¶å‘æ“ä½œæ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€å—ç”¨æ¥ä¸´æ—¶å­˜æ”¾ è¦æ”¶å‘çš„æ•°æ®çš„å†…å­˜ç©ºé—´ï¼Œè¿™å—å†…å­˜ç©ºé—´ç§°ä¸ºç¼“å†²åŒºï¼Œå®ƒä¹Ÿæ˜¯åœ¨è¿æ¥æ“ä½œ çš„è¿‡ç¨‹ä¸­åˆ†é…çš„

- ç½‘ç»œåŒ…ä¸­æ²¡æœ‰å®é™…çš„æ•°æ®ï¼Œåªæœ‰æ§åˆ¶ä¿¡æ¯ï¼Œè¿™äº›æ§ åˆ¶ä¿¡æ¯ä½äºç½‘ç»œåŒ…çš„å¼€å¤´ï¼Œå› æ­¤è¢«ç§°ä¸ºå¤´éƒ¨ã€‚

> tcpå¤´éƒ¨æ ¼å¼

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/JyiaEn.png)

> å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´äº¤æ¢çš„æ§åˆ¶ä¿¡æ¯

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/VFFvJn.png)

#### è¿æ¥æ“ä½œçš„å®é™…è¿‡ç¨‹

> ipæ¨¡å—

è¿™ä¸ªè¿‡ç¨‹æ˜¯ä»åº”ç”¨ç¨‹åºè°ƒç”¨ Socket åº“çš„ connect å¼€å§‹çš„ã€‚

connect(< æè¿°ç¬¦ >, < æœåŠ¡å™¨ IP åœ°å€å’Œç«¯å£å· >, ...)

> tcpæ¨¡å—ï¼ˆ3æ­¤æ¡æ‰‹ï¼‰

å®¢æˆ·ç«¯ï¼šåœ¨ TCP å¤´éƒ¨ä¸­è®¾ç½®å‘é€æ–¹å’Œæ¥æ”¶ æ–¹ç«¯å£å·ä»¥åŠ SYN æ¯”ç‰¹ã€‚
æœåŠ¡ç«¯ï¼šè¿”å›å“åº”æ—¶è¿˜éœ€è¦å°† ACK æ§åˆ¶ä½è®¾ä¸º1ï¼Œè¡¨ç¤ºå·²ç»æ”¶åˆ°ï¼ŒæœåŠ¡å™¨ TCP æ¨¡å—ä¼šå°† TCP å¤´éƒ¨ä¼ é€’ç»™ IP æ¨¡å—ï¼Œå¹¶å§”æ‰˜ IP æ¨¡å—å‘å®¢æˆ·ç«¯è¿”å›å“åº”ã€‚
å®¢æˆ·ç«¯ï¼šç½‘ç»œåŒ…å°±ä¼šè¿”å›åˆ°å®¢æˆ·ç«¯ï¼Œé€šè¿‡ IP æ¨¡å—åˆ°è¾¾ TCP æ¨¡å—ï¼Œé€šè¿‡ TCP å¤´éƒ¨çš„ä¿¡æ¯ç¡®è®¤è¿æ¥æœåŠ¡å™¨çš„æ“ä½œæ˜¯å¦æˆåŠŸï¼Œå¦‚æœ SYN ä¸º 1 åˆ™è¡¨ï¼Œç¤ºè¿æ¥æˆåŠŸï¼Œè¿™æ—¶ä¼šå‘å¥—æ¥å­—ä¸­å†™å…¥æœåŠ¡å™¨çš„ IP åœ°å€ã€ç«¯å£å·ç­‰ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜ä¼šå°†çŠ¶æ€æ”¹ä¸ºè¿æ¥å®Œæ¯•ã€‚å®¢æˆ·ç«¯ä¹Ÿéœ€è¦å°† ACK æ¯”ç‰¹è®¾ç½®ä¸º 1 å¹¶å‘å›æœåŠ¡å™¨ï¼Œå‘Šè¯‰æœåŠ¡å™¨åˆšæ‰çš„å“åº” åŒ…å·²ç»æ”¶åˆ°ã€‚
æœåŠ¡å™¨ï¼šæ”¶åˆ°è¿™ä¸ªè¿”å›åŒ…ä¹‹åï¼Œè¿æ¥æ“ä½œæ‰ç®—å…¨éƒ¨å®Œæˆã€‚

åªè¦æ•°æ®ä¼ è¾“è¿‡ç¨‹åœ¨æŒç»­ï¼Œä¹Ÿå°±æ˜¯åœ¨è°ƒç”¨ close æ–­ å¼€ä¹‹å‰ï¼Œè¿æ¥æ˜¯ä¸€ç›´å­˜åœ¨çš„ã€‚å»ºç«‹è¿æ¥ä¹‹åï¼Œåè®®æ ˆçš„è¿æ¥æ“ä½œå°±ç»“æŸäº†ï¼Œä¹Ÿå°±æ˜¯è¯´ connect å·²ç» æ‰§è¡Œå®Œæ¯•ï¼Œæ§åˆ¶æµç¨‹è¢«äº¤å›åˆ°åº”ç”¨ç¨‹åºã€‚

#### å°† HTTP è¯·æ±‚æ¶ˆæ¯äº¤ç»™åè®®æ ˆ

æ•°æ®æ”¶å‘æ“ä½œæ˜¯ä»åº”ç”¨ç¨‹åºè°ƒç”¨ write å°†è¦å‘é€çš„æ•°æ®äº¤ç»™åè®®æ ˆå¼€å§‹çš„ã€‚åè®®æ ˆå¹¶ä¸å…³å¿ƒåº”ç”¨ç¨‹åºä¼ æ¥çš„æ•°æ®æ˜¯ä»€ä¹ˆå†…å®¹ã€‚åº”ç”¨ç¨‹åºåœ¨è°ƒç”¨ write æ—¶ä¼šæŒ‡å®šå‘é€æ•°æ®çš„é•¿åº¦ï¼Œåœ¨åè®®æ ˆçœ‹æ¥ï¼Œè¦å‘é€çš„æ•°æ®å°±æ˜¯ä¸€å®šé•¿åº¦çš„äºŒè¿›åˆ¶å­—èŠ‚åºåˆ—è€Œå·²ã€‚

ä¸€æ¬¡å°†å¤šå°‘æ•°æ®äº¤ç»™åè®®æ ˆ æ˜¯ç”±åº”ç”¨ç¨‹åºè‡ªè¡Œå†³å®šçš„ï¼Œåè®®æ ˆå¹¶ä¸èƒ½æ§åˆ¶è¿™ä¸€è¡Œä¸ºã€‚å› æ­¤éœ€è¦åœ¨æ•°æ®ç§¯ç´¯åˆ°ä¸€å®šé‡æ—¶å†å‘é€å‡ºå»ã€‚

æ ¹æ®ä¸‹é¢å‡ ä¸ªè¦ç´ æ¥åˆ¤æ–­éœ€è¦å‘é€å¤šå°‘ä¸ªåŒ…ï¼š

1. ç¬¬ä¸€ä¸ªåˆ¤æ–­è¦ç´ æ˜¯æ¯ä¸ªç½‘ç»œåŒ…èƒ½å®¹çº³çš„æ•°æ®é•¿åº¦
2. MTU è¡¨ç¤ºä¸€ä¸ªç½‘ç»œåŒ…çš„æœ€å¤§é•¿åº¦ï¼Œåœ¨ä»¥å¤ªç½‘ä¸­ä¸€èˆ¬æ˜¯ 1500 å­—èŠ‚(å›¾ 2.5)
3. MSS:é™¤å»å¤´éƒ¨ä¹‹åï¼Œä¸€ä¸ªç½‘ç»œåŒ…æ‰€èƒ½å®¹çº³çš„ TCP æ•°æ®çš„æœ€å¤§ é•¿åº¦ã€‚

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/QwVEjF.png)

å¦ä¸€ä¸ªåˆ¤æ–­è¦ç´ æ˜¯æ—¶é—´ã€‚å½“åº”ç”¨ç¨‹åºå‘é€æ•°æ®çš„é¢‘ç‡ä¸é«˜çš„æ—¶å€™ï¼Œå¦‚ æœæ¯æ¬¡éƒ½ç­‰åˆ°é•¿åº¦æ¥è¿‘ MSS æ—¶å†å‘é€ï¼Œå¯èƒ½ä¼šå› ä¸ºç­‰å¾…æ—¶é—´å¤ªé•¿è€Œé€ æˆå‘é€å»¶è¿Ÿï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå³ä¾¿ç¼“å†²åŒºä¸­çš„æ•°æ®é•¿åº¦æ²¡æœ‰è¾¾åˆ° MSSï¼Œä¹Ÿåº”è¯¥æœ æ–­å‘é€å‡ºå»ã€‚ä¸ºæ­¤ï¼Œåè®®æ ˆçš„å†…éƒ¨æœ‰ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œå½“ç»è¿‡ä¸€å®šæ—¶é—´ä¹‹åï¼Œ å°±ä¼šæŠŠç½‘ç»œåŒ…å‘é€å‡ºå» Aã€‚

ç¨‹åºæŒ‡å®šä¸ç­‰å¾…å¡«æ»¡ç¼“å†²åŒºç›´æ¥å‘ é€â€ï¼Œåˆ™åè®®æ ˆå°±ä¼šæŒ‰ç…§è¦æ±‚ç›´æ¥å‘é€æ•°æ®ã€‚

#### å¯¹è¾ƒå¤§çš„æ•°æ®è¿›è¡Œæ‹†åˆ†

HTTP è¯·æ±‚æ¶ˆæ¯ä¸€èˆ¬ä¸ä¼šå¾ˆé•¿ï¼Œä¸€ä¸ªç½‘ç»œåŒ…å°±èƒ½è£…å¾—ä¸‹ï¼Œä½†å¦‚æœå…¶ä¸­ è¦æäº¤è¡¨å•æ•°æ®ï¼Œé•¿åº¦å°±å¯èƒ½è¶…è¿‡ä¸€ä¸ªç½‘ç»œåŒ…æ‰€èƒ½å®¹çº³çš„æ•°æ®é‡ï¼Œæ¯”å¦‚åœ¨ åšå®¢æˆ–è€…è®ºå›ä¸Šå‘è¡¨ä¸€ç¯‡é•¿æ–‡å°±å±äºè¿™ç§æƒ…å†µã€‚

> åº”ç”¨ç¨‹åºæ•°æ®çš„æ‹†åˆ†å‘é€

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/vX7T6E.png)

#### ä½¿ç”¨ ACK å·ç¡®è®¤ç½‘ç»œåŒ…å·²æ”¶åˆ°

> åºå·å’Œ ACK å·çš„ç”¨æ³•

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/NcWHwE.png)

> æ•°æ®åŒå‘ä¼ è¾“æ—¶çš„æƒ…å†µ

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/enCMDG.png)

> åºå·å’Œ ACK å·çš„äº¤äº’

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/7ri9Nx.png)

TCP é‡‡ç”¨è¿™æ ·çš„æ–¹å¼ç¡®è®¤å¯¹æ–¹æ˜¯å¦æ”¶åˆ°äº†æ•°æ®,åœ¨å¾—åˆ°å¯¹æ–¹ç¡®è®¤ä¹‹ å‰ï¼Œå‘é€è¿‡çš„åŒ…éƒ½ä¼šä¿å­˜åœ¨å‘é€ç¼“å†²åŒºä¸­ã€‚å¦‚æœå¯¹æ–¹æ²¡æœ‰è¿”å›æŸäº›åŒ…å¯¹åº” çš„ ACK å·ï¼Œé‚£ä¹ˆå°±é‡æ–°å‘é€è¿™äº›åŒ…ã€‚

ç½‘å¡ã€é›†çº¿å™¨ã€è·¯ç”±å™¨éƒ½æ²¡æœ‰é”™è¯¯è¡¥å¿æœºåˆ¶ï¼Œä¸€æ—¦æ£€æµ‹åˆ°é”™è¯¯ å°±ç›´æ¥ä¸¢å¼ƒç›¸åº”çš„åŒ…ã€‚åº”ç”¨ç¨‹åºä¹Ÿæ˜¯ä¸€æ ·ï¼Œå› ä¸ºé‡‡ç”¨ TCP ä¼ è¾“ï¼Œå³ä¾¿å‘ç”Ÿ ä¸€äº›é”™è¯¯å¯¹æ–¹æœ€ç»ˆä¹Ÿèƒ½å¤Ÿæ”¶åˆ°æ­£ç¡®çš„æ•°æ®ï¼Œæ‰€ä»¥åº”ç”¨ç¨‹åºåªç®¡è‡ªé¡¾è‡ªåœ°å‘ é€è¿™äº›æ•°æ®å°±å¥½äº†

ä¸è¿‡ï¼Œå¦‚æœå‘ç”Ÿç½‘ç»œä¸­æ–­ã€æœåŠ¡å™¨å®•æœºç­‰é—®é¢˜ï¼Œé‚£ä¹ˆ æ— è®º TCP æ€æ ·é‡ä¼ éƒ½ä¸ç®¡ç”¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ— è®ºå¦‚ä½•å°è¯•éƒ½æ˜¯å¾’åŠ³ï¼Œå›  æ­¤ TCP ä¼šåœ¨å°è¯•å‡ æ¬¡é‡ä¼ æ— æ•ˆä¹‹åå¼ºåˆ¶ç»“æŸé€šä¿¡ï¼Œå¹¶å‘åº”ç”¨ç¨‹åºæŠ¥é”™ã€‚

#### æ ¹æ®ç½‘ç»œåŒ…å¹³å‡å¾€è¿”æ—¶é—´è°ƒæ•´ ACK å·ç­‰å¾…æ—¶é—´

1. è¿”å› ACK å·çš„ç­‰å¾…æ—¶é—´(è¿™ä¸ªç­‰å¾… æ—¶é—´å«è¶…æ—¶æ—¶é—´)ã€‚
2. å½“ç½‘ç»œä¼ è¾“ç¹å¿™æ—¶å°±ä¼šå‘ç”Ÿæ‹¥å¡ï¼ŒACK å·çš„è¿”å›ä¼šå˜æ…¢ï¼Œè¿™æ—¶æˆ‘ä»¬å°± å¿…é¡»å°†ç­‰å¾…æ—¶é—´è®¾ç½®å¾—ç¨å¾®é•¿ä¸€ç‚¹ï¼Œå¦åˆ™å¯èƒ½ä¼šå‘ç”Ÿå·²ç»é‡ä¼ äº†åŒ…ä¹‹åï¼Œ å‰é¢çš„ ACK å·æ‰å§—å§—æ¥è¿Ÿçš„æƒ…å†µã€‚
3. ç­‰å¾…æ—¶é—´éœ€è¦è®¾ä¸ºä¸€ä¸ªåˆé€‚çš„å€¼ï¼Œä¸èƒ½å¤ªé•¿ä¹Ÿä¸èƒ½å¤ªçŸ­

#### ä½¿ç”¨çª—å£æœ‰æ•ˆç®¡ç† ACK å·

ACK å·çš„è¿™æ®µæ—¶é—´ï¼Œéœ€è¦æœ‰æ•ˆåˆ©ç”¨

> æ–¹å¼å¯¹æ¯”

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/tT9MPM.png)

1. å½“æ¥æ”¶æ–¹çš„ TCP æ”¶åˆ°åŒ…åï¼Œä¼šå…ˆå°†æ•°æ®å­˜æ”¾åˆ° æ¥æ”¶ç¼“å†²åŒºä¸­
2. å°†æ•°æ®å—ç»„è£…èµ·æ¥è¿˜åŸæˆåŸæœ¬çš„æ•°æ®å¹¶ä¼ é€’ç»™åº”ç”¨ç¨‹åºï¼Œå¦‚æœè¿™äº›æ“ä½œè¿˜æ²¡å®Œæˆä¸‹ä¸€ä¸ªåŒ…å°±åˆ°ä¸‹ä¸€ä¸ªï¼Œä¸‹ä¸€ä¸ªåŒ…ä¹Ÿä¼šè¢«æš‚å­˜åœ¨æ¥æ”¶ç¼“å†²åŒºä¸­ã€‚
3. æ•°æ®åˆ°è¾¾çš„ é€Ÿç‡æ¯”å¤„ç†è¿™äº›æ•°æ®å¹¶ä¼ é€’ç»™åº”ç”¨ç¨‹åºçš„é€Ÿç‡è¿˜è¦å¿«ï¼Œé‚£ä¹ˆæ¥æ”¶ç¼“å†²åŒºä¸­ çš„æ•°æ®å°±ä¼šè¶Šå †è¶Šå¤šï¼Œæœ€åå°±ä¼šæº¢å‡ºã€‚ï¼ˆé¿å…ï¼šæ¥æ”¶æ–¹éœ€è¦å‘Šè¯‰å‘é€æ–¹è‡ªå·±æœ€å¤šèƒ½æ¥æ”¶å¤šå°‘æ•°æ®ï¼‰

> æ»‘åŠ¨çª—å£ä¸æ¥æ”¶ç¼“å†²åŒº

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/xIOqYQ.png)

- ACK ä¸çª—å£çš„åˆå¹¶

- æ¥æ”¶ HTTP å“åº”æ¶ˆæ¯

### IP ä¸ä»¥å¤ªç½‘çš„åŒ…æ”¶å‘æ“ä½œ

> ç½‘ç»œåŒ…çš„ç»“æ„

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/sngZCn.png)

> å‘é€æ–¹ã€æ¥æ”¶æ–¹å’Œè½¬å‘è®¾å¤‡

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/PigTAV.png)

è·¯ç”±å™¨å’Œé›†çº¿å™¨

- è·¯ç”±å™¨æ ¹æ®ç›®æ ‡åœ°å€åˆ¤æ–­ä¸‹ä¸€ä¸ªè·¯ç”±å™¨çš„ä½ç½®
- é›†çº¿å™¨åœ¨å­ç½‘ä¸­å°†ç½‘ç»œåŒ…ä¼ è¾“åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±

é›†çº¿å™¨æ˜¯æŒ‰ç…§ä»¥å¤ªç½‘è§„åˆ™ä¼ è¾“åŒ…çš„è®¾å¤‡ï¼Œè·¯ç”±å™¨æ˜¯æŒ‰ç…§ IP è§„åˆ™ä¼ è¾“åŒ…çš„è®¾å¤‡

- IP åè®®æ ¹æ®ç›®æ ‡åœ°å€åˆ¤æ–­ä¸‹ä¸€ä¸ª IP è½¬å‘è®¾å¤‡çš„ä½ç½®
- å­ç½‘ä¸­çš„ä»¥å¤ªç½‘åè®®å°†åŒ…ä¼ è¾“åˆ°ä¸‹ä¸€ä¸ªè½¬å‘è®¾å¤‡

- (a)MAC å¤´éƒ¨(ç”¨äºä»¥å¤ªç½‘åè®®)
- (b)IP å¤´éƒ¨(ç”¨äº IP åè®®)

> Ipå¤´éƒ¨æ ¼å¼

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/LoOBx5.png)

> macå¤´éƒ¨æ ¼å¼

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/Z10VXt.png)

- MAC åœ°å€æ˜¯åœ¨ç½‘å¡ç”Ÿäº§æ—¶å†™å…¥ ROM é‡Œçš„ï¼Œåªè¦å°†è¿™ä¸ªå€¼è¯»å–å‡ºæ¥å†™å…¥ MAC å¤´éƒ¨å°±å¯ä»¥äº†ã€‚
- è®¾ç½®å‘é€æ–¹ IP åœ°å€æ—¶ï¼Œ æˆ‘ä»¬å·²ç»åˆ¤æ–­å‡ºäº†ä»å“ªå—ç½‘å¡å‘é€è¿™ä¸ªåŒ…ï¼Œé‚£ä¹ˆç°åœ¨åªè¦å°†è¿™å—ç½‘å¡å¯¹åº” çš„ MAC åœ°å€å¡«è¿›å»å°±å¥½äº†ã€‚
- æ¥æ”¶æ–¹æ‰€ä»¥å…ˆå¾—ææ¸…æ¥šåº”è¯¥æŠŠåŒ…å‘ç»™è°ï¼Œè¿™ä¸ªåªè¦æŸ¥ä¸€ä¸‹è·¯ç”±è¡¨ å°±çŸ¥é“äº†ã€‚åœ¨è·¯ç”±è¡¨ä¸­æ‰¾åˆ°ç›¸åŒ¹é…çš„æ¡ç›®ï¼Œç„¶åæŠŠåŒ…å‘ç»™ Gateway åˆ—ä¸­çš„ IP åœ°å€å°±å¯ä»¥äº†ã€‚

### é€šè¿‡ ARP æŸ¥è¯¢ç›®æ ‡è·¯ç”±å™¨çš„ MAC åœ°å€

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/0E7J5c.png)

- ARP ç¼“å­˜çš„å†…å­˜ç©ºé—´.å…ˆæŸ¥è¯¢ä¸€ä¸‹ ARP ç¼“å­˜ï¼Œå¦‚æœå…¶ä¸­å·²ç»ä¿å­˜ äº†å¯¹æ–¹çš„ MAC åœ°å€ï¼Œå°±ä¸éœ€è¦å‘é€ ARP æŸ¥è¯¢ï¼Œç›´æ¥ä½¿ç”¨ ARP ç¼“å­˜ä¸­çš„ åœ°å€ï¼Œè€Œå½“ ARP ç¼“å­˜ä¸­ä¸å­˜åœ¨å¯¹æ–¹ MAC åœ°å€æ—¶ï¼Œåˆ™å‘é€ ARP æŸ¥è¯¢.

> macåœ°å€

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/UjvXdY.png)

### ç½‘å¡

> ä»¥å¤ªç½‘ç»“æ„å›¾

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/kzMLtK.png)

ä»¥å¤ªç½‘çš„ä¸‰ä¸ªç‰¹ç‚¹

- å°†åŒ…å‘é€åˆ° MAC å¤´éƒ¨çš„æ¥æ”¶æ–¹ MAC åœ°å€ä»£è¡¨çš„ç›®çš„åœ°
- ç”¨å‘é€æ–¹ MAC åœ°å€è¯†åˆ«å‘é€æ–¹
- ç”¨ä»¥å¤ªç±»å‹è¯†åˆ«åŒ…çš„å†…å®¹

(ä»¥å¤ªç½‘å’Œè‹±ç‰¹ç½‘çš„å·®åˆ«)

- ä»¥å¤ªç½‘æ˜¯å±€åŸŸç½‘
- è‹±ç‰¹ç½‘æ˜¯å…·æœ‰å…¨çƒæ€§è´¨çš„

### å°† IP åŒ…è½¬æ¢æˆç”µæˆ–å…‰ä¿¡å·å‘é€å‡ºå»

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/s7RNs0.png)

- ç½‘å¡é©±åŠ¨ç¨‹åºä¼šå¯¹ç¡¬ä»¶è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œç„¶åç¡¬ä»¶æ‰è¿›å…¥å¯ä»¥ä½¿ç”¨çš„çŠ¶æ€
- æ§åˆ¶ä»¥å¤ªç½‘æ”¶å‘æ“ä½œçš„ MAC æ¨¡å—ä¸­è®¾ç½® MAC åœ°å€ã€‚
- ç½‘å¡çš„ ROM ä¸­ä¿å­˜ç€å…¨ä¸–ç•Œå”¯ä¸€çš„ MAC åœ°å€ï¼Œè¿™æ˜¯åœ¨ç”Ÿäº§ç½‘å¡æ—¶å†™å…¥çš„ï¼Œå°†è¿™ä¸ªå€¼è¯»å‡ºä¹‹åå°±å¯ä»¥å¯¹ MAC æ¨¡å—è¿›è¡Œè®¾ç½®ï¼ŒMAC æ¨¡å—å°±çŸ¥ é“è‡ªå·±å¯¹åº”çš„ MAC åœ°å€äº†

### ç»™ç½‘ç»œåŒ…å†åŠ  3 ä¸ªæ§åˆ¶æ•°æ®

ç½‘å¡æ˜¯å¦‚ä½•å°†åŒ…è½¬æ¢æˆç”µä¿¡å·å¹¶å‘é€åˆ°ç½‘çº¿ä¸­çš„ï¼Œç½‘å¡é©±åŠ¨ä» IP æ¨¡å—è·å–åŒ…ä¹‹åï¼Œä¼šå°†å…¶å¤åˆ¶åˆ°ç½‘å¡å†…çš„ç¼“å†²åŒºä¸­ï¼Œç„¶åå‘ MAC æ¨¡å—å‘é€å‘é€åŒ…çš„å‘½ä»¤

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/D7X5O6.png)

### ç”µä¿¡å·å’Œæ—¶é’Ÿä¿¡å·

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/ciANJL.png)

### å‘é›†çº¿å™¨å‘é€ç½‘ç»œåŒ…

- åŠåŒå·¥é€šä¿¡
å‘é€å’Œæ¥æ”¶åŒæ—¶å¹¶è¡Œçš„æ–¹å¼å«ä½œâ€œå…¨åŒå·¥â€

- åŒå·¥é€šä¿¡
æŸä¸€æ—¶åˆ»åªèƒ½è¿›è¡Œå‘é€æˆ–æ¥æ”¶å…¶ä¸­ä¸€ç§æ“ä½œçš„å«ä½œâ€œåŠåŒå·¥â€

MAC æ¨¡å—ä»æŠ¥å¤´å¼€å§‹å°†æ•°å­—ä¿¡æ¯æŒ‰æ¯ä¸ªæ¯”ç‰¹è½¬æ¢æˆç”µä¿¡å·ï¼Œç„¶åç”± PHYï¼Œ æˆ–è€…å« MAU çš„ä¿¡å·æ”¶å‘æ¨¡å—å‘é€å‡ºå»ã€‚å°†æ•°å­—ä¿¡æ¯è½¬æ¢ä¸ºç”µä¿¡å·çš„é€Ÿç‡å°±æ˜¯ç½‘ç»œçš„ä¼ è¾“é€Ÿç‡ï¼ŒPHY(MAU)æ¨¡å—ä¼šå°†ä¿¡å·è½¬æ¢ä¸ºå¯åœ¨ç½‘çº¿ä¸Šä¼ è¾“çš„æ ¼å¼ã€‚
MAC æ¨¡å—å°†å¯è½¬æ¢ä¸ºä»»æ„æ ¼å¼çš„é€šç”¨ä¿¡å·å‘é€ç»™ PHY(MAU)æ¨¡å—ï¼Œç„¶å PHY(MAU)æ¨¡å— å†å°†å…¶è½¬æ¢ä¸ºå¯åœ¨ç½‘çº¿ä¸Šä¼ è¾“çš„æ ¼å¼ã€‚

### UDPåè®®çš„æ”¶å‘

å’ŒTCPåè®®ç›¸æ¯”UDPåè®®æ˜¯ä¸å¯é çš„

#### UDP å¤´éƒ¨ä¸­çš„æ§åˆ¶ä¿¡æ¯

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/lbQlmm.png)

## ä»ç½‘çº¿åˆ°ç½‘ç»œè®¾å¤‡

é€šè¿‡ç½‘çº¿ä¼ è¾“ å‡ºå»çš„åŒ…æ˜¯å¦‚ä½•ç»è¿‡é›†çº¿å™¨ã€äº¤æ¢æœºå’Œè·¯ç”±å™¨ç­‰ç½‘ç»œè®¾å¤‡ï¼Œæœ€ç»ˆè¿›å…¥äº’è”
ç½‘çš„ã€‚

### ä¿¡å·åœ¨ç½‘çº¿å’Œé›†çº¿å™¨ä¸­ä¼ è¾“

ä¿¡å·ä»è®¡ç®—æœºä¸­æµå‡ºä¹‹åï¼Œä¼šåœ¨ç½‘çº¿ä¸­ç»è¿‡é›†çº¿å™¨ç­‰è®¾å¤‡å‰è¿›ã€‚æ­¤æ—¶ï¼Œ ä¿¡å·æ˜¯å¦‚ä½•åœ¨ç½‘çº¿å’Œé›†çº¿å™¨ä¼ è¾“çš„ï¼Ÿã€‚ä¿¡å·åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¼šè¡°å‡ï¼Œè¿˜ä¼šå—åˆ°å™ªå£°å¹²æ‰°è€Œå¤±çœŸï¼Œå¦‚ä½•æŠ‘åˆ¶è¿™äº›å½±å“ï¼Ÿ

#### æ¯ä¸ªåŒ…éƒ½æ˜¯ç‹¬ç«‹ä¼ è¾“çš„

è½¬å‘è®¾å¤‡ä¼šæ ¹æ®åŒ…å¤´éƒ¨ä¸­çš„æ§åˆ¶ä¿¡æ¯ï¼Œåœ¨è½¬å‘è®¾å¤‡å†…éƒ¨ä¸€ä¸ªå†™æœ‰è½¬å‘è§„åˆ™çš„è¡¨ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œä»¥æ­¤æ¥åˆ¤æ–­åŒ…çš„ç›®çš„åœ°ï¼Œç„¶åå°†åŒ…æœç›®çš„åœ°çš„æ–¹å‘è¿›è¡Œè½¬å‘ã€‚

> å±€åŸŸç½‘çš„ç®€å•ç»“æ„

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/ZqJEYD.png)

- ä»¥å¤ªç½‘ä¿¡å·çš„æœ¬è´¨æ˜¯æ­£è´Ÿå˜åŒ–çš„ç”µå‹ï¼Œå¤§ å®¶å¯ä»¥è®¤ä¸ºç½‘å¡çš„ PHY(MAU)æ¨¡å—å°±æ˜¯ä¸€ä¸ªä»æ­£è´Ÿä¸¤ä¸ªä¿¡å·ç«¯å­è¾“å‡ºä¿¡ å·çš„ç”µè·¯ã€‚
- ä¿¡å·åˆ°è¾¾é›†çº¿å™¨çš„æ—¶å€™å¹¶ä¸æ˜¯è·Ÿåˆšå‘é€å‡ºå»çš„æ—¶å€™ä¸€æ¨¡ä¸€æ ·ã€‚ é›†çº¿å™¨æ”¶åˆ°çš„ä¿¡å·æœ‰æ—¶ä¼šå‡ºç°è¡°å‡ã€‚
- ä¿¡å·åœ¨ç½‘çº¿çš„ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œèƒ½é‡ä¼šé€æ¸æŸå¤±ã€‚ç½‘çº¿è¶Šé•¿ï¼Œä¿¡å·è¡°å‡å°±è¶Šä¸¥é‡ã€‚

#### åŒç»â€æ˜¯ä¸ºäº†æŠ‘åˆ¶å™ªå£°

- äº§ç”Ÿå™ªå£°çš„åŸå› æ˜¯ç½‘çº¿å‘¨å›´çš„ç”µç£æ³¢ï¼Œå½“ç”µç£æ³¢æ¥è§¦åˆ°é‡‘å±ç­‰å¯¼ä½“ æ—¶ï¼Œåœ¨å…¶ä¸­å°±ä¼šäº§ç”Ÿç”µæµã€‚

#### é›†çº¿å™¨å°†ä¿¡å·å‘å¾€æ‰€æœ‰çº¿è·¯

ä»¥å¤ªç½‘çš„åŸºæœ¬æ¶æ„ A å°±æ˜¯å°†åŒ…å‘åˆ°æ‰€æœ‰çš„è®¾å¤‡ï¼Œç„¶åç”±è®¾å¤‡æ ¹æ®æ¥æ”¶æ–¹ MAC åœ°å€æ¥åˆ¤æ–­åº”è¯¥æ¥ æ”¶å“ªäº›åŒ…ï¼Œè€Œé›†çº¿å™¨å°±æ˜¯è¿™ä¸€æ¶æ„çš„å¿ å®ä½“ç°ï¼Œå®ƒå°±æ˜¯è´Ÿè´£æŒ‰ç…§ä»¥å¤ªç½‘çš„åŸºæœ¬æ¶æ„å°†ä¿¡å·å¹¿æ’­å‡ºå»ã€‚

> äº¤å‰ç½‘çº¿çš„ä½¿ç”¨

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/C3GdKo.png)

> äº¤å‰ç½‘çº¿

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/ZwgFMk.png)

### äº¤æ¢æœºçš„åŒ…è£…æ“ä½œ

äº¤æ¢æœºçš„è®¾è®¡æ˜¯å°†ç½‘ç»œåŒ…åŸæ · è½¬å‘åˆ°ç›®çš„åœ°.

#### äº¤æ¢æœºæ ¹æ®åœ°å€è¡¨è¿›è¡Œè½¬å‘

- PHY(MAU)æ¨¡å—ä¼šå°†ç½‘çº¿ä¸­çš„ä¿¡å·è½¬æ¢ä¸ºé€šç”¨æ ¼å¼,ç„¶åä¼ é€’ç»™ `MAC` æ¨¡å—ã€‚
- MAC æ¨¡å—å°†ä¿¡å·è½¬æ¢ä¸ºæ•°å­—ä¿¡æ¯ï¼Œç„¶åé€šè¿‡åŒ…æœ«å°¾çš„ FCS æ ¡éªŒé”™è¯¯ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜åˆ™å­˜æ”¾åˆ°ç¼“å†²åŒºä¸­ã€‚

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/4CpyHw.png)

äº¤æ¢æœºçš„å·¥ä½œæ–¹å¼å’Œç½‘å¡æœ‰ä¸€ç‚¹ä¸åŒã€‚ç½‘å¡æœ¬èº«å…·æœ‰ MAC åœ°å€ï¼Œå¹¶é€šè¿‡æ ¸å¯¹æ”¶åˆ°çš„åŒ…çš„æ¥æ”¶æ–¹ MAC åœ°å€åˆ¤æ–­æ˜¯ä¸æ˜¯å‘ç»™è‡ªå·±çš„ï¼Œå¦‚æœä¸æ˜¯å‘ç»™è‡ªå·±çš„åˆ™ä¸¢å¼ƒã€‚äº¤æ¢æœºçš„ç«¯å£ä¸æ ¸å¯¹æ¥æ”¶æ–¹ MAC åœ°å€ï¼Œè€Œæ˜¯ç›´æ¥æ¥æ”¶æ‰€æœ‰çš„åŒ…å¹¶å­˜æ”¾åˆ°ç¼“å†²åŒºä¸­ã€‚å’Œç½‘å¡ä¸åŒï¼Œäº¤æ¢æœºçš„ç«¯å£ä¸å…·æœ‰ MAC åœ°å€ã€‚

#### MAC åœ°å€è¡¨çš„ç»´æŠ¤

- ç¬¬ä¸€ç§æ˜¯æ”¶åˆ°åŒ…æ—¶ï¼Œå°†å‘é€æ–¹ MAC åœ°å€ä»¥åŠå…¶è¾“å…¥ç«¯å£çš„å·ç å†™å…¥ MACåœ°å€è¡¨ä¸­ã€‚
- å¦ä¸€ç§æ˜¯åˆ é™¤åœ°å€è¡¨ä¸­æŸæ¡è®°å½•çš„æ“ä½œï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢è®¾å¤‡ç§»åŠ¨æ—¶äº§ç”Ÿé—®é¢˜ã€‚é˜²æ­¢ç»ˆç«¯è®¾å¤‡ç§»åŠ¨äº§ç”Ÿé—®é¢˜ï¼Œåªéœ€è¦å°†ä¸€æ®µæ—¶é—´ä¸ä½¿ç”¨çš„è¿‡æ—¶è®°å½•ä»åœ°å€è¡¨ä¸­åˆ é™¤å°±å¯ä»¥äº†ã€‚

äº¤æ¢æœºä¼šè‡ªè¡Œæ›´æ–°æˆ–åˆ é™¤åœ°å€è¡¨ä¸­çš„è®°å½•ï¼Œä¸éœ€è¦æ‰‹åŠ¨ç»´æŠ¤

#### ç‰¹æ®Šæ“ä½œ

- äº¤æ¢æœºå‘ç°ä¸€ä¸ªåŒ…è¦å‘å›åˆ°åŸç«¯å£æ—¶ï¼Œå°±ä¼šç›´æ¥ä¸¢å¼ƒè¿™ä¸ªåŒ…
- åœ°å€è¡¨ä¸­æ‰¾ä¸åˆ°æŒ‡å®šçš„ MAC åœ°å€ï¼Œäº¤æ¢æœºæ— æ³•åˆ¤æ–­åº”è¯¥æŠŠåŒ…è½¬å‘åˆ°å“ªä¸ªç«¯å£ï¼Œåªèƒ½å°†åŒ…è½¬å‘åˆ°é™¤äº†æºç«¯å£ä¹‹å¤–çš„æ‰€æœ‰ç«¯ å£ä¸Šï¼Œæ— è®ºè¯¥è®¾å¤‡è¿æ¥åœ¨å“ªä¸ªç«¯å£ä¸Šéƒ½èƒ½æ”¶åˆ°è¿™ä¸ªåŒ…ã€‚
- å¦‚æœæ¥æ”¶æ–¹ MAC åœ°å€æ˜¯ä¸€ä¸ªå¹¿æ’­åœ°å€ Aï¼Œé‚£ä¹ˆäº¤æ¢æœºä¼šå°†åŒ…å‘é€åˆ°é™¤æºç«¯å£ä¹‹å¤–çš„æ‰€æœ‰ç«¯å£

> ä¸å‘æºç«¯å£è½¬å‘ç½‘ç»œåŒ…

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/N4GyXU.png)

#### å…¨åŒå·¥æ¨¡å¼å¯ä»¥åŒæ—¶è¿›è¡Œå‘é€å’Œæ¥æ”¶

- å…¨åŒå·¥æ¨¡å¼æ˜¯äº¤æ¢æœºç‰¹æœ‰çš„å·¥ä½œæ¨¡å¼ï¼Œå®ƒå¯ä»¥åŒæ—¶è¿›è¡Œå‘é€å’Œæ¥æ”¶æ“ä½œï¼Œé›†çº¿å™¨ä¸å…·å¤‡è¿™æ ·çš„ç‰¹æ€§ã€‚

- ä½¿ç”¨åŒç»çº¿æ—¶ï¼Œå‘é€å’Œæ¥æ”¶çš„ä¿¡å·çº¿æ˜¯å„è‡ªç‹¬ç«‹çš„ã€‚åœ¨åŒç»çº¿ä¸­ä¿¡å·ä¸ä¼šå‘ç”Ÿç¢°æ’ã€‚

- ç½‘çº¿è¿æ¥çš„å¦ä¸€ç«¯ï¼Œå³äº¤æ¢æœºç«¯å£å’Œç½‘å¡çš„ PHY (MAU)æ¨¡å—ä»¥åŠ MAC æ¨¡å—ï¼Œå…¶å†…éƒ¨å‘é€å’Œæ¥æ”¶ç”µè·¯ä¹Ÿæ˜¯å„è‡ªç‹¬ç«‹çš„ï¼Œä¿¡å·ä¹Ÿä¸ä¼šå‘ç”Ÿç¢°æ’

- åœ¨å…¨åŒå·¥æ¨¡å¼ä¸‹ï¼Œæ— éœ€ç­‰å¾…å…¶ ä»–ä¿¡å·ç»“æŸå°±å¯ä»¥å‘é€ä¿¡å·ï¼Œå› æ­¤å®ƒæ¯”åŠåŒå·¥æ¨¡å¼é€Ÿåº¦è¦å¿«ã€‚ç”±äºåŒæ–¹å¯ä»¥åŒæ—¶å‘é€æ•°æ®ï¼Œæ‰€ä»¥å¯åŒæ—¶ä¼ è¾“çš„æ•°æ®é‡ä¹Ÿæ›´å¤§ï¼Œæ€§èƒ½ä¹Ÿå°±æ›´é«˜ã€‚

#### è‡ªåŠ¨åå•†:ç¡®å®šæœ€ä¼˜çš„ä¼ è¾“é€Ÿç‡

è‡ªåŠ¨åˆ‡æ¢å·¥ä½œæ¨¡å¼çš„åŠŸèƒ½ã€‚è¿™ä¸€åŠŸèƒ½å¯ ä»¥ç”±ç›¸äº’è¿æ¥çš„åŒæ–¹æ¢æµ‹å¯¹æ–¹æ˜¯å¦æ”¯æŒå…¨åŒå·¥æ¨¡å¼ï¼Œå¹¶è‡ªåŠ¨åˆ‡æ¢æˆç›¸åº”çš„å·¥ä½œæ¨¡å¼ã€‚æ­¤å¤–ï¼Œé™¤äº†èƒ½è‡ªåŠ¨åˆ‡æ¢å·¥ä½œæ¨¡å¼ä¹‹å¤–ï¼Œè¿˜èƒ½æ¢æµ‹å¯¹æ–¹çš„ä¼ è¾“é€Ÿç‡å¹¶è¿›è¡Œè‡ªåŠ¨åˆ‡æ¢ã€‚

#### äº¤æ¢æœºå¯åŒæ—¶æ‰§è¡Œå¤šä¸ªè½¬å‘æ“ä½œ

- äº¤æ¢æœºåªå°†åŒ…è½¬å‘åˆ°å…·æœ‰ç‰¹å®š MAC åœ°å€çš„è®¾å¤‡è¿æ¥çš„ç«¯å£ï¼Œå…¶ä»–ç«¯å£éƒ½æ˜¯ç©ºé—²çš„ã€‚
- å½“åŒ…ä»æœ€ä¸Šé¢çš„ç«¯å£å‘é€åˆ°æœ€ä¸‹ é¢çš„ç«¯å£æ—¶ï¼Œå…¶ä»–ç«¯å£éƒ½å¤„äºç©ºé—²çŠ¶æ€ï¼Œè¿™äº›ç«¯å£å¯ä»¥ä¼ è¾“å…¶ä»–çš„åŒ…ã€‚å› æ­¤äº¤æ¢æœºå¯ä»¥åŒæ—¶è½¬å‘å¤šä¸ªåŒ…ã€‚
- ç›¸å¯¹åœ°ï¼Œé›†çº¿å™¨ä¼šå°†è¾“å…¥çš„ä¿¡å·å¹¿æ’­åˆ°æ‰€æœ‰çš„ç«¯å£ï¼Œå¦‚æœåŒæ—¶è¾“å…¥å¤šä¸ªä¿¡å·å°±ä¼šå‘ç”Ÿç¢°æ’ï¼Œæ— æ³•åŒæ—¶ä¼ è¾“å¤šè·¯ä¿¡å·ï¼Œå› æ­¤ä»è®¾å¤‡æ•´ä½“çš„è½¬å‘èƒ½åŠ›æ¥çœ‹ï¼Œäº¤æ¢æœºè¦é«˜äºé›†çº¿å™¨ã€‚

### è·¯ç”±å™¨çš„åŒ…è½¬å‘æ“ä½œ

è·¯ç”±å™¨å’Œäº¤æ¢æœºæ˜¯æœ‰åŒºåˆ«çš„ã€‚å› ä¸ºè·¯ç”±å™¨æ˜¯åŸºäº IP è®¾è®¡çš„ï¼Œè€Œäº¤æ¢æœºæ˜¯åŸºäºä»¥å¤ªç½‘è®¾è®¡çš„ã€‚

- è½¬å‘æ¨¡å—è´Ÿè´£åˆ¤æ–­åŒ…çš„è½¬å‘ç›®çš„åœ°
- ç«¯å£æ¨¡å—è´Ÿè´£åŒ…çš„æ”¶å‘æ“ä½œ
- è·¯ç”±å™¨è½¬å‘æ¨¡ å—å’Œç«¯å£æ¨¡å—çš„å…³ç³»ï¼Œå°±ç›¸å½“äºåè®®æ ˆçš„ IP æ¨¡å—å’Œç½‘å¡ä¹‹é—´çš„å…³ç³»
- è·¯ç”±å™¨çš„ç«¯å£å…·æœ‰ MAC åœ°å€ï¼Œå› æ­¤å®ƒå°±èƒ½å¤Ÿæˆä¸ºä»¥å¤ªç½‘çš„å‘é€æ–¹å’Œæ¥æ”¶æ–¹ï¼Œç«¯å£è¿˜å…·æœ‰ IP åœ°å€ï¼Œä»è¿™ä¸ªæ„ä¹‰ä¸Šæ¥è¯´ï¼Œå®ƒå’Œè®¡ç®—æœºçš„ç½‘å¡æ˜¯ä¸€æ ·çš„ã€‚å½“è½¬å‘åŒ…æ—¶ï¼Œé¦–å…ˆè·¯ç”±å™¨ç«¯å£ä¼šæ¥æ”¶å‘ç»™è‡ªå·±çš„ä»¥å¤ªç½‘åŒ…ï¼Œç„¶åæŸ¥è¯¢è½¬å‘ç›®æ ‡ï¼Œå†ç”±ç›¸åº”çš„ç«¯å£ä½œä¸ºå‘é€æ–¹å°†ä»¥å¤ªç½‘åŒ…å‘é€å‡ºå»ã€‚
- äº¤æ¢æœºåªæ˜¯å°†è¿›æ¥çš„åŒ…è½¬å‘å‡ºå»è€Œå·²ï¼Œå®ƒè‡ªå·±å¹¶ä¸ä¼šæˆä¸º å‘é€æ–¹æˆ–è€…æ¥æ”¶æ–¹ã€‚
- è·¯ç”±å™¨ä¼šå¿½ç•¥ä¸»æœºå·ï¼ŒåªåŒ¹é…ç½‘ç»œå·ã€‚

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/LW6mIS.png)

> è·¯ç”±èšåˆ

è·¯ç”±èšåˆï¼Œå¤šä¸ªå­ç½‘ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªå­ç½‘ï¼Œå­ç½‘æ©ç ä¼šå‘ç”Ÿ å˜åŒ–ï¼ŒåŒæ—¶ï¼Œç›®æ ‡åœ°å€åˆ—ä¹Ÿä¼šæ”¹æˆèšåˆåçš„åœ°å€ã€‚

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/yRcoxq.png)

- æ ¹æ®ç›®æ ‡åœ°å€å’Œå­ç½‘ æ©ç åŒ¹é…åˆ°æŸæ¡è®°å½•åï¼Œè·¯ç”±å™¨å°±ä¼šå°†ç½‘ç»œåŒ…äº¤ç»™æ¥å£åˆ—ä¸­æŒ‡å®šçš„ç½‘ç»œæ¥å£(å³ç«¯å£)ï¼Œå¹¶è½¬å‘åˆ°ç½‘å…³åˆ—ä¸­æŒ‡å®šçš„ IP åœ°å€

è·¯ç”±è¡¨è¿›è¡Œç»´æŠ¤çš„æ–¹æ³•æœ‰å‡ ç§

- äººæ‰‹åŠ¨ç»´æŠ¤è·¯ç”±è®°å½•
- æ ¹æ®è·¯ç”±åè®®æœºåˆ¶ï¼Œé€šè¿‡è·¯ç”±å™¨ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ç”±è·¯ç”±å™¨è‡ªè¡Œç»´æŠ¤è·¯ç”±è¡¨çš„è®°å½•

#### è·¯ç”±å™¨çš„åŒ…æ¥æ”¶æ“ä½œ

- ä¿¡å·åˆ°è¾¾ç½‘çº¿æ¥å£éƒ¨åˆ†ï¼Œå…¶ä¸­çš„ PHY(MAU)æ¨¡å—å’Œ MAC æ¨¡å—å°†ä¿¡å·è½¬æ¢ä¸ºæ•°å­—ä¿¡æ¯ï¼Œç„¶åé€šè¿‡åŒ…æœ«å°¾çš„ FCS è¿›è¡Œé”™è¯¯æ ¡éªŒã€‚
- å¦‚æœæ²¡é—®é¢˜åˆ™æ£€æŸ¥ MAC å¤´éƒ¨ä¸­çš„æ¥æ”¶æ–¹ MAC åœ°å€ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å‘ç»™è‡ªå·±çš„åŒ…
- å¦‚æœæ˜¯å°±æ”¾åˆ°æ¥æ”¶ç¼“å†²åŒºä¸­ï¼Œå¦åˆ™å°±ä¸¢å¼ƒè¿™ä¸ªåŒ…
- å¦‚æœåŒ…çš„æ¥æ”¶æ–¹ MAC åœ°å€ä¸æ˜¯è‡ªå·±ï¼Œè¯´æ˜è¿™ä¸ªåŒ…æ˜¯å‘ç»™å…¶ä»–è®¾å¤‡çš„ï¼Œå¦‚æœæ¥æ”¶è¿™ä¸ªåŒ…å°±è¿åäº†ä»¥å¤ªç½‘çš„è§„åˆ™ã€‚

#### æŸ¥è¯¢è·¯ç”±è¡¨ç¡®å®šè¾“å‡ºç«¯å£

- å®ŒæˆåŒ…æ¥æ”¶æ“ä½œä¹‹åï¼Œè·¯ç”±å™¨å°±ä¼šä¸¢å¼ƒåŒ…å¼€å¤´çš„ MAC å¤´éƒ¨
- MAC å¤´éƒ¨çš„ä½œç”¨å°±æ˜¯å°†åŒ…é€è¾¾è·¯ç”±å™¨ï¼Œå…¶ä¸­çš„æ¥æ”¶æ–¹ MAC åœ°å€å°±æ˜¯è·¯ç”±å™¨ç«¯å£çš„ MAC åœ°å€ã€‚

#### æ‰¾ä¸åˆ°åŒ¹é…è·¯ç”±æ—¶é€‰æ‹©é»˜è®¤è·¯ç”±

- å­ç½‘æ©ç  0.0.0.0 çš„æ„æ€æ˜¯ç½‘ç»œåŒ…æ¥æ”¶æ–¹ IP åœ°å€å’Œè·¯ç”±è¡¨ç›®æ ‡åœ°å€ çš„åŒ¹é…ä¸­éœ€è¦åŒ¹é…çš„æ¯”ç‰¹æ•°ä¸º 0ï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯æ ¹æœ¬ä¸éœ€è¦åŒ¹é…
- åªè¦ å°†å­ç½‘æ©ç è®¾ç½®ä¸º 0.0.0.0ï¼Œé‚£ä¹ˆæ— è®ºä»»ä½•åœ°å€éƒ½èƒ½åŒ¹é…åˆ°è¿™ä¸€æ¡è®°å½•ï¼Œè¿™ æ ·å°±ä¸ä¼šå‘ç”Ÿä¸çŸ¥é“è¦è½¬å‘åˆ°å“ªé‡Œçš„é—®é¢˜äº†ã€‚

#### åŒ…çš„æœ‰æ•ˆæœŸ

TTL(Time to Liveï¼Œç”Ÿå­˜æ—¶é—´)

- åŒ…æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨çš„è½¬å‘ï¼ŒTTLå°±ä¼šå‡ 1ï¼Œå½“è¿™ä¸ªå€¼å˜æˆ 0 æ—¶ï¼Œå°±è¡¨ç¤ºè¶…è¿‡äº†æœ‰æ•ˆæœŸï¼Œè¿™ä¸ªåŒ…å°±ä¼šè¢«ä¸¢å¼ƒã€‚
- è¿™ä¸ªæœºåˆ¶æ˜¯ä¸ºäº†é˜²æ­¢åŒ…åœ¨ä¸€ä¸ªåœ°æ–¹é™·å…¥æ­»å¾ªç¯

#### é€šè¿‡åˆ†ç‰‡åŠŸèƒ½æ‹†åˆ†å¤§ç½‘ç»œåŒ…

ä¸åŒçš„çº¿è·¯å’Œå±€åŸŸç½‘ç±»å‹å„è‡ªèƒ½ä¼ è¾“çš„æœ€å¤§åŒ…é•¿åº¦ä¹Ÿä¸åŒï¼Œå› æ­¤ è¾“å‡ºç«¯å£çš„æœ€å¤§åŒ…é•¿åº¦å¯èƒ½ä¼šå°äºè¾“å…¥ç«¯å£ï¼Œå³ä¾¿ä¸¤ä¸ªç«¯å£çš„æœ€å¤§åŒ…é•¿åº¦ç›¸åŒï¼Œä¹Ÿå¯èƒ½ä¼šå› ä¸ºæ·»åŠ äº†ä¸€äº›å¤´éƒ¨æ•°æ®è€Œå¯¼è‡´åŒ…çš„å®é™…é•¿åº¦å‘ç”Ÿå˜åŒ–ã€‚
![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/5pT9Yt.png)

### è·¯ç”±å™¨çš„é™„åŠ åŠŸèƒ½

è·¯ç”±å™¨é™¤äº†åŸºæœ¬åŠŸèƒ½ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›é™„åŠ åŠŸèƒ½ã€‚

#### åœ°å€è½¬æ¢

åœ¨å†…ç½‘ä¸­å¯ç”¨ä½œç§æœ‰åœ°å€çš„èŒƒå›´ä»…é™ ä»¥ä¸‹è¿™äº›ã€‚

- 10.0.0.0 ~ 10.255.255.255
- 172.16.0.0 ~ 172.31.255.255
- 192.168.0.0 ~ 192.168.255.255

> ç§æœ‰åœ°å€å’Œå…¬æœ‰åœ°å€åˆ†åˆ«ç®¡ç†

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/JZS0Se.png)

#### åœ°å€è½¬æ¢çš„åŸºæœ¬åŸç†

åœ°å€è½¬æ¢çš„åŸºæœ¬åŸç†æ˜¯åœ¨è½¬å‘ç½‘ç»œåŒ…æ—¶å¯¹ IP å¤´éƒ¨ä¸­çš„ IP åœ°å€å’Œç«¯å£å·è¿›è¡Œæ”¹å†™ã€‚

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/YHUAbb.png)

## é€šè¿‡æ¥å…¥ç½‘è¿›å…¥äº’è”ç½‘å†…éƒ¨

çœ‹ä¸€çœ‹ç½‘ç»œåŒ…æ˜¯å¦‚ä½•é€šè¿‡äº’è”ç½‘æ¥å…¥è·¯ç”±å™¨ï¼Œæœ€ç»ˆè¿›å…¥äº’è”ç½‘å†…éƒ¨çš„

### ADSL æ¥å…¥ç½‘çš„ç»“æ„å’Œå·¥ä½œæ–¹å¼

> äº’è”ç½‘çš„æ•´ä½“æ¶æ„

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/qzgOvg.png)

äº’è”ç½‘çš„åŸºæœ¬ç»“æ„ä¸å®¶åº­ã€å…¬å¸ç½‘ç»œä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å°†äº’è”ç½‘ç†è§£ä¸ºå®¶åº­ã€å…¬å¸ç½‘ç»œçš„ä¸€ä¸ªæ”¾å¤§ç‰ˆã€‚

- è·ç¦»çš„ä¸åŒå’Œè·¯ç”±çš„ç»´æŠ¤æ–¹å¼ï¼Œå°±æ˜¯äº’è”ç½‘ä¸å®¶åº­ã€å…¬å¸ç½‘ç»œä¹‹é—´æœ€ä¸»è¦çš„ä¸¤ä¸ªä¸åŒç‚¹ã€‚

#### æ¥å…¥ç½‘

æŒ‡è¿æ¥äº’è”ç½‘ä¸å®¶åº­ã€å…¬å¸ç½‘ç»œçš„é€šä¿¡çº¿è·¯ã€‚ä¸€èˆ¬å®¶ç”¨çš„æ¥å…¥ç½‘æ–¹å¼åŒ…æ‹¬ ADSLBã€FTTHCã€CATVã€ç”µè¯çº¿ã€ISDN ç­‰ï¼Œå…¬å¸åˆ™è¿˜å¯èƒ½ä½¿ç”¨ä¸“çº¿ã€‚æ¥å…¥ç½‘çš„çº¿è·¯æœ‰å¾ˆå¤šç§ç±»ï¼Œæˆ‘ä»¬æ— æ³•æ¢ç´¢æ‰€æœ‰è¿™äº›çº¿è·¯ï¼Œå› æ­¤ä¸‹é¢å…ˆä»‹ç»ä¸€ä¸ªæ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„ä¾‹å­â€”â€”ADSLã€‚

> ç½‘ç»œåŒ…å½¢æ€çš„å˜åŒ–

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/3xr8j7.png)

#### ADSL Modem å°†åŒ…æ‹†åˆ†æˆä¿¡å…ƒ

> ä¿¡å·çš„è°ƒåˆ¶

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/ZeAaIz.png)

#### è¿æ¥ç”¨æˆ·ä¸äº’è”ç½‘çš„æ¥å…¥ç½‘

> ä»ç”¨æˆ·åˆ°ç”µè¯å±€

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/r3C2qSv.png)

### å…‰çº¤æ¥å…¥ç½‘(FTTH)

å…‰çº¤æ˜¯ç”±ä¸€ç§åŒå±‚ç»“æ„çš„çº¤ç»´çŠ¶é€æ˜æè´¨(ç»ç’ƒå’Œå¡‘æ–™)æ„æˆçš„ï¼Œé€šè¿‡åœ¨é‡Œé¢çš„çº¤èŠ¯ä¸­ä¼ å¯¼å…‰ä¿¡å·æ¥ä¼ è¾“æ•°å­—ä¿¡æ¯ã€‚ADSL ä¿¡å·æ˜¯ç”±å¤šä¸ªé¢‘æ®µçš„ä¿¡å·ç»„æˆçš„ï¼Œæ¯”è¾ƒå¤æ‚ï¼Œä½†å…‰ä¿¡å·å´é å¸¸ç®€å•ï¼Œäº®è¡¨ç¤º 1ï¼Œæš—è¡¨ç¤º 0ã€‚

> å…‰çº¤çš„ç»“æ„
![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/SK8zmH.png)

> å…‰çº¤çš„é€šä¿¡åŸç†

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/pDeAzS.png)

- æ•°å­—ä¿¡æ¯å¹¶ä¸èƒ½ä¸€ä¸‹å­å˜æˆå…‰ä¿¡å·ï¼Œå…ˆå°†æ•°å­—ä¿¡æ¯è½¬æ¢æˆç”µä¿¡å·ï¼Œç„¶åå†å°†ç”µä¿¡å·è½¬æ¢æˆå…‰ä¿¡å·ã€‚è¿™é‡Œçš„ç”µä¿¡å·éå¸¸ç®€å•ï¼Œ1 ç”¨é«˜ç”µå‹è¡¨ç¤ºï¼Œ0 ç”¨ä½ç”µå‹è¡¨ç¤ºã€‚
- å°†è¿™æ ·çš„ç”µä¿¡å·è¾“å…¥ LEDã€æ¿€å…‰äºŒæç®¡ç­‰å…‰æºåï¼Œè¿™äº›å…‰æºå°±ä¼šæ ¹æ®ä¿¡å·ç”µå‹çš„å˜åŒ–å‘å…‰ï¼Œ é«˜ç”µå‹å‘å…‰äº®ï¼Œä½ç”µå‹å‘å…‰æš—ã€‚

### æ¥å…¥ç½‘ä¸­ä½¿ç”¨çš„ PPP å’Œéš§é“

äº’è”ç½‘æœ¬æ¥å°±æ˜¯ç”±å¾ˆå¤šå°è·¯ç”±å™¨ç›¸äº’è¿æ¥ç»„æˆçš„ï¼Œå› æ­¤åŸåˆ™ä¸Šåº”è¯¥æ˜¯ å°†æ¥å…¥ç½‘è¿æ¥åˆ°è·¯ç”±å™¨ä¸Šã€‚éšç€æ¥å…¥ç½‘å‘å±•åˆ° ADSL å’Œ FTTHï¼Œæ¥å…¥ç½‘è¿æ¥çš„è·¯ç”±å™¨ä¹Ÿè·Ÿç€æ¼”è¿›ï¼Œè€Œè¿™ç§è¿›åŒ–å‹çš„è·¯ç”±å™¨å°±å«ä½œ BASã€‚

#### PPP

PPP æ‹¨å·è¿æ¥æ“ä½œ

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/A6mVZV.png)

#### PPPoE

PPPoE æ˜¯ç”±ä¼ ç»Ÿç”µè¯æ‹¨å· ä¸Šç½‘ä¸Šä½¿ç”¨çš„ PPP åè®®å‘å±•è€Œæ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€çœ‹ PPP æ‹¨å·ä¸Šç½‘çš„å·¥ä½œæ–¹å¼ã€‚

### ç½‘ç»œè¿è¥å•†çš„å†…éƒ¨

#### POP å’Œ NOC

> äº’è”ç½‘å†…éƒ¨æ¦‚è§ˆ

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/DGdYjV.png)

> POPæ¦‚è§ˆ

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/h9MP8b.png)

### è·¨è¶Šè¿è¥å•†çš„ç½‘ç»œåŒ…

> è¿è¥å•†ä¹‹é—´çš„è·¯ç”±ä¿¡æ¯äº¤æ¢

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/qCQWpW.png)

> è·¯ç”±ä¿¡æ¯äº¤æ¢çš„ç±»å‹

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/Fhht2W.png)

## æœåŠ¡å™¨ç«¯çš„å±€åŸŸç½‘

### Web æœåŠ¡å™¨çš„éƒ¨ç½²åœ°ç‚¹

> æœåŠ¡å™¨ä½ç½®

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/5WSpYm.png)

- ç¬¬ä¸€ç§ï¼Œç½‘ç»œåŒ…è£¸å¥”ï¼Œä¸å®‰å…¨ï¼Œ
- é˜²ç«å¢™å¯ä»¥å¯¹ç½‘ç»œåŒ…è¿›è¡Œå®‰å…¨æ£€æŸ¥
- æ•°æ®ä¸­å¿ƒé€šè¿‡é«˜é€Ÿçº¿è·¯ç›´æ¥è¿æ¥åˆ°äº’è”ç½‘çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå½“æœåŠ¡å™¨è®¿é—®é‡å¾ˆå¤§æ—¶è¿™æ˜¯éå¸¸æœ‰æ•ˆçš„ã€‚

### é˜²ç«å¢™çš„ç»“æ„å’ŒåŸç†

> åœ°å€è½¬æ¢å’ŒåŒ…è¿‡æ»¤ä¸­ç”¨äºè®¾ç½®è§„åˆ™çš„å­—æ®µ
![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/D1sIio.png)

> åŒ…è¿‡æ»¤çš„ç¤ºä¾‹
![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/MEVYb2.png)

- ä¹Ÿå¯ä»¥é€šè¿‡ç«¯å£å·æ¥é™å®šåº”ç”¨ç¨‹åºæ˜¯å¦å¯ä»¥é€šè¿‡
- ä»å…¬å¸å†…ç½‘è®¿é—®å…¬å¼€åŒºåŸŸçš„è§„åˆ™
- ä»å¤–éƒ¨æ— æ³•è®¿é—®å…¬å¸å†…ç½‘
- å½“ç½‘ç»œåŒ…ç»è¿‡æ—¶ï¼Œå¯ä»¥é€šè¿‡é˜²ç«å¢™

### é€šè¿‡å°†è¯·æ±‚å¹³å‡åˆ†é…ç»™å¤šå°æœåŠ¡å™¨æ¥å¹³è¡¡è´Ÿè½½

æ€§èƒ½ä¸è¶³æ—¶éœ€è¦è´Ÿè½½å‡è¡¡

é€šè¿‡è½®è¯¢çš„æ–¹å¼æ¥æŒ‡å®šè®¿é—®æœåŠ¡å™¨IPåœ°å€

> DNSè½®è¯¢

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/iglWS7.png)

> è´Ÿè½½å‡è¡¡å™¨

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/VNzctz.png)

> ç¼“å­˜æœåŠ¡å™¨å·¥ä½œæµç¨‹

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/hVjUF1.png)

> åˆ©ç”¨ä»£ç†å®ç°é˜²ç«å¢™

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/RuPtoV.png)

> ç¼“å­˜æœåŠ¡å™¨çš„ä¸‰ç§éƒ¨ç½²æ–¹å¼

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/fDGXca.png)

> å¦‚ä½•æ‰¾åˆ°æœ€è¿‘çš„ç¼“å­˜æœåŠ¡å™¨

![img](https://gitee.com/PENG_YUE/myImg/raw/master/uPic/BNKwaj.png)

### åˆ©ç”¨ç¼“å­˜æœåŠ¡å™¨åˆ†æ‹…è´Ÿè½½
