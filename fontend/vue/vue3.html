<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue3.0 | PengYYY</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Happy Life ğŸ€,  Working Smooth ğŸ’»">
    
    <link rel="preload" href="/my-blog/assets/css/0.styles.3606043a.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.0ef53e14.js" as="script"><link rel="preload" href="/my-blog/assets/js/2.df0a347f.js" as="script"><link rel="preload" href="/my-blog/assets/js/110.f9a16118.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/10.2801256c.js"><link rel="prefetch" href="/my-blog/assets/js/100.2e400952.js"><link rel="prefetch" href="/my-blog/assets/js/101.590e25a8.js"><link rel="prefetch" href="/my-blog/assets/js/102.9f167645.js"><link rel="prefetch" href="/my-blog/assets/js/103.fd3ccfc1.js"><link rel="prefetch" href="/my-blog/assets/js/104.1105cee1.js"><link rel="prefetch" href="/my-blog/assets/js/105.dc657231.js"><link rel="prefetch" href="/my-blog/assets/js/106.a2d51144.js"><link rel="prefetch" href="/my-blog/assets/js/107.4219c414.js"><link rel="prefetch" href="/my-blog/assets/js/108.ea1c71c8.js"><link rel="prefetch" href="/my-blog/assets/js/109.40bf6287.js"><link rel="prefetch" href="/my-blog/assets/js/11.5c98febd.js"><link rel="prefetch" href="/my-blog/assets/js/111.28bde672.js"><link rel="prefetch" href="/my-blog/assets/js/112.d179a417.js"><link rel="prefetch" href="/my-blog/assets/js/113.2a9096c0.js"><link rel="prefetch" href="/my-blog/assets/js/114.706f747b.js"><link rel="prefetch" href="/my-blog/assets/js/115.43622622.js"><link rel="prefetch" href="/my-blog/assets/js/116.649055b8.js"><link rel="prefetch" href="/my-blog/assets/js/117.87a7785b.js"><link rel="prefetch" href="/my-blog/assets/js/118.21fb68b5.js"><link rel="prefetch" href="/my-blog/assets/js/119.391e58af.js"><link rel="prefetch" href="/my-blog/assets/js/12.dea5f0e5.js"><link rel="prefetch" href="/my-blog/assets/js/120.b4dc928c.js"><link rel="prefetch" href="/my-blog/assets/js/121.476e0f3d.js"><link rel="prefetch" href="/my-blog/assets/js/122.9eac55d1.js"><link rel="prefetch" href="/my-blog/assets/js/123.37f6dfce.js"><link rel="prefetch" href="/my-blog/assets/js/13.9ed8968b.js"><link rel="prefetch" href="/my-blog/assets/js/14.0b1a70c0.js"><link rel="prefetch" href="/my-blog/assets/js/15.8925af36.js"><link rel="prefetch" href="/my-blog/assets/js/16.c87608d1.js"><link rel="prefetch" href="/my-blog/assets/js/17.07edf7b8.js"><link rel="prefetch" href="/my-blog/assets/js/18.0784b42c.js"><link rel="prefetch" href="/my-blog/assets/js/19.1e719016.js"><link rel="prefetch" href="/my-blog/assets/js/20.91cc4163.js"><link rel="prefetch" href="/my-blog/assets/js/21.b7b0fa5d.js"><link rel="prefetch" href="/my-blog/assets/js/22.3931e563.js"><link rel="prefetch" href="/my-blog/assets/js/23.3493a4fb.js"><link rel="prefetch" href="/my-blog/assets/js/24.7d3a6cb4.js"><link rel="prefetch" href="/my-blog/assets/js/25.6cd213b4.js"><link rel="prefetch" href="/my-blog/assets/js/26.ef1c0ea6.js"><link rel="prefetch" href="/my-blog/assets/js/27.eeace530.js"><link rel="prefetch" href="/my-blog/assets/js/28.e5974a1b.js"><link rel="prefetch" href="/my-blog/assets/js/29.753ac330.js"><link rel="prefetch" href="/my-blog/assets/js/3.d7834cfe.js"><link rel="prefetch" href="/my-blog/assets/js/30.2b217e50.js"><link rel="prefetch" href="/my-blog/assets/js/31.fbd822fb.js"><link rel="prefetch" href="/my-blog/assets/js/32.2a92b4f5.js"><link rel="prefetch" href="/my-blog/assets/js/33.5e4449ca.js"><link rel="prefetch" href="/my-blog/assets/js/34.fb5f1bf7.js"><link rel="prefetch" href="/my-blog/assets/js/35.5bd53f3e.js"><link rel="prefetch" href="/my-blog/assets/js/36.e302888b.js"><link rel="prefetch" href="/my-blog/assets/js/37.ac95653e.js"><link rel="prefetch" href="/my-blog/assets/js/38.429cb560.js"><link rel="prefetch" href="/my-blog/assets/js/39.545b355d.js"><link rel="prefetch" href="/my-blog/assets/js/4.03235a2f.js"><link rel="prefetch" href="/my-blog/assets/js/40.cd9824fa.js"><link rel="prefetch" href="/my-blog/assets/js/41.3d0ea84a.js"><link rel="prefetch" href="/my-blog/assets/js/42.5333af86.js"><link rel="prefetch" href="/my-blog/assets/js/43.0a588551.js"><link rel="prefetch" href="/my-blog/assets/js/44.dbfa7349.js"><link rel="prefetch" href="/my-blog/assets/js/45.a1c4bf25.js"><link rel="prefetch" href="/my-blog/assets/js/46.711d144b.js"><link rel="prefetch" href="/my-blog/assets/js/47.cf9ba86d.js"><link rel="prefetch" href="/my-blog/assets/js/48.61cd13a7.js"><link rel="prefetch" href="/my-blog/assets/js/49.2df7b286.js"><link rel="prefetch" href="/my-blog/assets/js/5.a556b432.js"><link rel="prefetch" href="/my-blog/assets/js/50.5d9ee899.js"><link rel="prefetch" href="/my-blog/assets/js/51.24812116.js"><link rel="prefetch" href="/my-blog/assets/js/52.06419b22.js"><link rel="prefetch" href="/my-blog/assets/js/53.93f43246.js"><link rel="prefetch" href="/my-blog/assets/js/54.5c51a3ad.js"><link rel="prefetch" href="/my-blog/assets/js/55.c5a64763.js"><link rel="prefetch" href="/my-blog/assets/js/56.32045283.js"><link rel="prefetch" href="/my-blog/assets/js/57.0934b785.js"><link rel="prefetch" href="/my-blog/assets/js/58.14242ce5.js"><link rel="prefetch" href="/my-blog/assets/js/59.c1621902.js"><link rel="prefetch" href="/my-blog/assets/js/6.0f1039b1.js"><link rel="prefetch" href="/my-blog/assets/js/60.8ca8af20.js"><link rel="prefetch" href="/my-blog/assets/js/61.58bf56f4.js"><link rel="prefetch" href="/my-blog/assets/js/62.f377f50a.js"><link rel="prefetch" href="/my-blog/assets/js/63.736aadbf.js"><link rel="prefetch" href="/my-blog/assets/js/64.d3ae2ac6.js"><link rel="prefetch" href="/my-blog/assets/js/65.9a097331.js"><link rel="prefetch" href="/my-blog/assets/js/66.76d312c0.js"><link rel="prefetch" href="/my-blog/assets/js/67.1734a5bd.js"><link rel="prefetch" href="/my-blog/assets/js/68.6facbfbe.js"><link rel="prefetch" href="/my-blog/assets/js/69.003da1e2.js"><link rel="prefetch" href="/my-blog/assets/js/7.387d883a.js"><link rel="prefetch" href="/my-blog/assets/js/70.457ddd35.js"><link rel="prefetch" href="/my-blog/assets/js/71.c0dc3455.js"><link rel="prefetch" href="/my-blog/assets/js/72.853b5102.js"><link rel="prefetch" href="/my-blog/assets/js/73.213c3a58.js"><link rel="prefetch" href="/my-blog/assets/js/74.edcf6826.js"><link rel="prefetch" href="/my-blog/assets/js/75.c880cc10.js"><link rel="prefetch" href="/my-blog/assets/js/76.b6f8c115.js"><link rel="prefetch" href="/my-blog/assets/js/77.3d570e45.js"><link rel="prefetch" href="/my-blog/assets/js/78.9ee516da.js"><link rel="prefetch" href="/my-blog/assets/js/79.719b87ef.js"><link rel="prefetch" href="/my-blog/assets/js/8.afc6d5ca.js"><link rel="prefetch" href="/my-blog/assets/js/80.f717798f.js"><link rel="prefetch" href="/my-blog/assets/js/81.942f7986.js"><link rel="prefetch" href="/my-blog/assets/js/82.46077de0.js"><link rel="prefetch" href="/my-blog/assets/js/83.1e7399de.js"><link rel="prefetch" href="/my-blog/assets/js/84.8403292d.js"><link rel="prefetch" href="/my-blog/assets/js/85.a20cd9b5.js"><link rel="prefetch" href="/my-blog/assets/js/86.8c7c71e2.js"><link rel="prefetch" href="/my-blog/assets/js/87.03e27673.js"><link rel="prefetch" href="/my-blog/assets/js/88.990dbbfb.js"><link rel="prefetch" href="/my-blog/assets/js/89.217aa324.js"><link rel="prefetch" href="/my-blog/assets/js/9.0705089f.js"><link rel="prefetch" href="/my-blog/assets/js/90.8be56005.js"><link rel="prefetch" href="/my-blog/assets/js/91.e3116598.js"><link rel="prefetch" href="/my-blog/assets/js/92.fbcd5c2e.js"><link rel="prefetch" href="/my-blog/assets/js/93.e282dd8a.js"><link rel="prefetch" href="/my-blog/assets/js/94.ba53ce65.js"><link rel="prefetch" href="/my-blog/assets/js/95.db22ac2e.js"><link rel="prefetch" href="/my-blog/assets/js/96.80b39ad2.js"><link rel="prefetch" href="/my-blog/assets/js/97.f3920b6d.js"><link rel="prefetch" href="/my-blog/assets/js/98.acc782da.js"><link rel="prefetch" href="/my-blog/assets/js/99.58988589.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.3606043a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-blog/" class="home-link router-link-active"><!----> <span class="site-name">PengYYY</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-blog/fontend/" class="nav-link router-link-active">
  å‰ç«¯
</a></div><div class="nav-item"><a href="/my-blog/algorithm/" class="nav-link">
  ç®—æ³•
</a></div><div class="nav-item"><a href="/my-blog/backend/" class="nav-link">
  åç«¯
</a></div><div class="nav-item"><a href="/my-blog/network/" class="nav-link">
  ç½‘ç»œ
</a></div><div class="nav-item"><a href="/my-blog/conclusion/" class="nav-link">
  æ€»ç»“
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-blog/fontend/" class="nav-link router-link-active">
  å‰ç«¯
</a></div><div class="nav-item"><a href="/my-blog/algorithm/" class="nav-link">
  ç®—æ³•
</a></div><div class="nav-item"><a href="/my-blog/backend/" class="nav-link">
  åç«¯
</a></div><div class="nav-item"><a href="/my-blog/network/" class="nav-link">
  ç½‘ç»œ
</a></div><div class="nav-item"><a href="/my-blog/conclusion/" class="nav-link">
  æ€»ç»“
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-blog/fontend/vue/core.html" class="sidebar-link">Vueæ ¸å¿ƒ</a></li><li><a href="/my-blog/fontend/vue/vue3.html" aria-current="page" class="active sidebar-link">Vue3.0</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/fontend/vue/vue3.html#vue3-0åˆå§‹åŒ–æµç¨‹" class="sidebar-link">vue3.0åˆå§‹åŒ–æµç¨‹</a></li><li class="sidebar-sub-header"><a href="/my-blog/fontend/vue/vue3.html#æ•°æ®å“åº”å¼" class="sidebar-link">æ•°æ®å“åº”å¼</a></li><li class="sidebar-sub-header"><a href="/my-blog/fontend/vue/vue3.html#vue3-0çš„ä¼˜åŒ–" class="sidebar-link">vue3.0çš„ä¼˜åŒ–</a></li><li class="sidebar-sub-header"><a href="/my-blog/fontend/vue/vue3.html#æ–°ç‰¹æ€§" class="sidebar-link">æ–°ç‰¹æ€§</a></li><li class="sidebar-sub-header"><a href="/my-blog/fontend/vue/vue3.html#composition-apiåŸç†" class="sidebar-link">Composition APIåŸç†</a></li></ul></li><li><a href="/my-blog/fontend/vue/reactive.html" class="sidebar-link">æ•°æ®å“åº”å¼</a></li><li><a href="/my-blog/fontend/vue/vue-router.html" class="sidebar-link">vue-router</a></li><li><a href="/my-blog/fontend/vue/vuex.html" class="sidebar-link">vuex</a></li><li><a href="/my-blog/fontend/vue/vue-question.html" class="sidebar-link">vueå¸¸è§é—®é¢˜</a></li><li><a href="/my-blog/fontend/vue/vite.html" class="sidebar-link">vite</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ¡†æ¶å¯¹æ¯”</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å·¥ç¨‹åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ€§èƒ½ä¼˜åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æµè§ˆå™¨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML &amp;&amp; CSS</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue3-0"><a href="#vue3-0" class="header-anchor">#</a> Vue3.0</h1> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/DrJG06.png" alt="img"></p> <h2 id="vue3-0åˆå§‹åŒ–æµç¨‹"><a href="#vue3-0åˆå§‹åŒ–æµç¨‹" class="header-anchor">#</a> vue3.0åˆå§‹åŒ–æµç¨‹</h2> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/sYzDwc.png" alt="img"></p> <p>ç®€å•çš„å®ç°</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vue3çš„åˆå§‹åŒ–æµç¨‹</span>
<span class="token keyword">const</span> Vue <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºrender, æ­¤å¤„å¯æ ¹æ®ä¸åŒå¹³å°å»åˆ›å»ºä¸åŒçš„render</span>
    <span class="token keyword">const</span> render <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createRender</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token parameter">select</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">insert</span><span class="token punctuation">(</span><span class="token parameter">children<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> anchor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parent<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> anchor <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">createRender</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> querySelector<span class="token punctuation">,</span> insert <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token comment">// æŒ‚è½½å‡½æ•°</span>
          <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> parent <span class="token operator">=</span> <span class="token function">querySelector</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>render<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              options<span class="token punctuation">.</span>render <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>setup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>setupState <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// ç¡®è®¤renderä¸­æ•°æ®ä»å“ªè·å–</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
              <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> target<span class="token punctuation">.</span>setupState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token keyword">return</span> target<span class="token punctuation">.</span>setupState<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                  <span class="token keyword">return</span> target<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token function">Set</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> target<span class="token punctuation">.</span>setupState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  target<span class="token punctuation">.</span>setupState<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                  target<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token keyword">const</span> el <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>proxy<span class="token punctuation">)</span>
            parent<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">''</span>
            <span class="token comment">// parent.appendChild(el)</span>
            <span class="token function">insert</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> parent<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment">// ç¼–è¯‘å‡½æ•°ï¼Œçœç•¥</span>
          <span class="token function">compile</span><span class="token punctuation">(</span><span class="token parameter">template</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">const</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;h3&quot;</span><span class="token punctuation">)</span>
              node<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title
              <span class="token keyword">return</span> node
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="header-anchor">#</a> æ­¥éª¤</h3> <ul><li>æŒ‚è½½mount
<ul><li>è·å–parent</li></ul></li> <li>ç¼–è¯‘
<ul><li>compile</li> <li>render</li></ul></li> <li>å…¼å®¹compositionApi
<ul><li>setup</li></ul></li> <li>æ¸²æŸ“,æ’å…¥èŠ‚ç‚¹</li></ul> <h2 id="æ•°æ®å“åº”å¼"><a href="#æ•°æ®å“åº”å¼" class="header-anchor">#</a> æ•°æ®å“åº”å¼</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">isObject</span> <span class="token operator">=</span> <span class="token parameter">val</span> <span class="token operator">=&gt;</span> val <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">'object'</span>

<span class="token keyword">function</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj
  <span class="token punctuation">}</span>
  <span class="token comment">// Proxyç›¸å½“äºåœ¨å¯¹è±¡å¤–å±‚åŠ æ‹¦æˆª</span>
  <span class="token keyword">const</span> observed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Reflectç”¨äºæ‰§è¡Œå¯¹è±¡é»˜è®¤æ“ä½œï¼Œæ›´è§„èŒƒã€æ›´å‹å¥½</span>
      <span class="token comment">// Proxyå’ŒObjectçš„æ–¹æ³•Reflectéƒ½æœ‰å¯¹åº”</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">è·å–</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token comment">// ä¾èµ–æ”¶é›†</span>
      <span class="token function">track</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token function">isObject</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">reactive</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">:</span> res
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">è®¾ç½®</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token function">trigger</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
      <span class="token keyword">return</span> res
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">deleteProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">deleteProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">åˆ é™¤</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token function">trigger</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
      <span class="token keyword">return</span> res
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> observed
<span class="token punctuation">}</span>

<span class="token keyword">const</span> effectStack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">function</span> <span class="token function">effect</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">rxEffect</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.æ•è·å¼‚å¸¸</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// 2.å…¥æ ˆ</span>
      effectStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>rxEffect<span class="token punctuation">)</span>
      <span class="token comment">// 3.è§¦å‘ä¾èµ–æ”¶é›†</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      <span class="token comment">// 4.å‡ºæ ˆ</span>
      effectStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">rxEffect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> rxEffect
<span class="token punctuation">}</span>

<span class="token comment">// ä¾èµ–æ”¶é›†ï¼Œå»ºç«‹targetï¼Œkeyå’Œä¸Šé¢çš„effectå‡½æ•°ä¹‹é—´æ˜ å°„å…³ç³»</span>
<span class="token comment">// éœ€è¦ä¸€ä¸ªæ•°æ®ç»“æ„å­˜å‚¨è¯¥å…³ç³»</span>
<span class="token comment">// {target: {key: [cb1, cb2, ...]}}</span>
<span class="token keyword">let</span> targetMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">track</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è·å–effectå­˜å…¥çš„å‡½æ•°</span>
  <span class="token keyword">const</span> effect <span class="token operator">=</span> effectStack<span class="token punctuation">[</span>effectStack<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>effect<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–targetå¯¹åº”Map</span>
    <span class="token keyword">let</span> depsMap <span class="token operator">=</span> targetMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>depsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      depsMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      targetMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> depsMap<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// è·å–depsMapä¸­keyå’Œå…¶å€¼ï¼Œä¹Ÿå°±æ˜¯Set</span>
    <span class="token keyword">let</span> deps <span class="token operator">=</span> depsMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>deps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// é¦–æ¬¡depsä¸å­˜åœ¨ï¼Œåˆ›å»ºä¹‹</span>
      deps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      depsMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> deps<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å°†ä¼ å…¥effectï¼Œæ·»åŠ åˆ°Seté‡Œé¢</span>
    deps<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>deps<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è·å–æ˜ å°„å…³ç³»</span>
  <span class="token keyword">const</span> depsMap <span class="token operator">=</span> targetMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>depsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–å‡½æ•°é›†åˆ</span>
    <span class="token keyword">const</span> deps <span class="token operator">=</span> depsMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    deps<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">effect</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
  bar<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'effect:'</span><span class="token punctuation">,</span> state<span class="token punctuation">.</span>foo<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

state<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">'fooooooo'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br></div></div><h2 id="vue3-0çš„ä¼˜åŒ–"><a href="#vue3-0çš„ä¼˜åŒ–" class="header-anchor">#</a> vue3.0çš„ä¼˜åŒ–</h2> <p>vue3.0å¸¦æ¥çš„ä¼˜åŒ–</p> <h3 id="ä»£ç ç»„ç»‡"><a href="#ä»£ç ç»„ç»‡" class="header-anchor">#</a> ä»£ç ç»„ç»‡</h3> <ul><li>vue3.0ä»£ç ç»“æ„</li></ul> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/tUoPsF.png" alt="img"></p> <p>æ›´å¥½çš„ä»£ç ç®¡ç†æ–¹å¼ï¼šmonorepo</p> <p>Vue 2.x çš„æºç æ‰˜ç®¡åœ¨ src ç›®å½•ï¼Œç„¶åä¾æ®åŠŸèƒ½æ‹†åˆ†å‡ºäº† compilerï¼ˆæ¨¡æ¿ç¼–è¯‘çš„ç›¸å…³ä»£ç ï¼‰ã€coreï¼ˆä¸å¹³å°æ— å…³çš„é€šç”¨è¿è¡Œæ—¶ä»£ç ï¼‰ã€platformsï¼ˆå¹³å°ä¸“æœ‰ä»£ç ï¼‰ã€serverï¼ˆæœåŠ¡ç«¯æ¸²æŸ“çš„ç›¸å…³ä»£ç ï¼‰ã€sfcï¼ˆ.vue å•æ–‡ä»¶è§£æç›¸å…³ä»£ç ï¼‰ã€sharedï¼ˆå…±äº«å·¥å…·ä»£ç ï¼‰</p> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/Q5GHQE.png" alt="img"></p> <p>Vue 3.0 ï¼Œæ•´ä¸ªæºç æ˜¯é€šè¿‡ monorepo çš„æ–¹å¼ç»´æŠ¤çš„ï¼Œæ ¹æ®åŠŸèƒ½å°†ä¸åŒçš„æ¨¡å—æ‹†åˆ†åˆ° packages</p> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/vjReQ9.png" alt="img"></p> <p>monorepo æŠŠè¿™äº›æ¨¡å—æ‹†åˆ†åˆ°ä¸åŒçš„ package ä¸­ï¼Œæ¯ä¸ª package æœ‰å„è‡ªçš„ APIã€ç±»å‹å®šä¹‰å’Œæµ‹è¯•ã€‚è¿™æ ·ä½¿å¾—æ¨¡å—æ‹†åˆ†æ›´ç»†åŒ–ï¼ŒèŒè´£åˆ’åˆ†æ›´æ˜ç¡®ï¼Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ä¹Ÿæ›´åŠ æ˜ç¡®ã€‚
å¦å¤–ä¸€äº› packageï¼ˆæ¯”å¦‚ reactivity å“åº”å¼åº“ï¼‰æ˜¯å¯ä»¥ç‹¬ç«‹äº Vue.js ä½¿ç”¨çš„ï¼Œè¿™æ ·ç”¨æˆ·å¦‚æœåªæƒ³ä½¿ç”¨ Vue.js 3.0 çš„å“åº”å¼èƒ½åŠ›ï¼Œå¯ä»¥å•ç‹¬ä¾èµ–è¿™ä¸ªå“åº”å¼åº“è€Œä¸ç”¨å»ä¾èµ–æ•´ä¸ª Vue.jsï¼Œå‡å°äº†å¼•ç”¨åŒ…çš„ä½“ç§¯å¤§å°ã€‚</p> <h3 id="è™šæ‹Ÿdomé‡å†™"><a href="#è™šæ‹Ÿdomé‡å†™" class="header-anchor">#</a> è™šæ‹Ÿdomé‡å†™</h3> <p>åšäº†ä¸€äº›é™æ€æ ‡è®°ï¼Œé’ˆå¯¹ä¸åŒç±»å‹å¯¹èŠ‚ç‚¹è¿›è¡Œä¸åŒç­–ç•¥çš„å¤„ç†ï¼Œé™æ€èŠ‚ç‚¹åœ¨diffè¿‡ç¨‹ä¸­ä¼šç›´æ¥è·³è¿‡ã€‚</p> <h3 id="æ€§èƒ½æå‡"><a href="#æ€§èƒ½æå‡" class="header-anchor">#</a> æ€§èƒ½æå‡</h3> <ol><li>æ›´å¥½çš„åˆå§‹æ€§èƒ½</li> <li>tree-shakingæ”¯æŒï¼Œæ›´å°çš„æ–‡ä»¶å¤§å°</li> <li>composition Apiæ–°è¯­æ³•</li> <li>fragment,teleport,suspenseæ–°ç»„ä»¶</li> <li>æ›´å¥½çš„typescriptæ”¯æŒ</li> <li>è‡ªå®šä¹‰æ¸²æŸ“å™¨</li></ol> <p>tree-shakingåŸç†ï¼šä¾èµ– ES2015 æ¨¡å—è¯­æ³•çš„é™æ€ç»“æ„ï¼ˆå³ import å’Œ exportï¼‰ï¼Œé€šè¿‡ç¼–è¯‘é˜¶æ®µçš„é™æ€åˆ†æï¼Œæ‰¾åˆ°æ²¡æœ‰å¼•å…¥çš„æ¨¡å—å¹¶æ‰“ä¸Šæ ‡è®°ã€‚æœªè¢«å¼•å…¥çš„ square æ¨¡å—ä¼šè¢«æ ‡è®°ï¼Œç„¶åå‹ç¼©é˜¶æ®µä¼šåˆ©ç”¨ä¾‹å¦‚ uglify-jsã€terser ç­‰å‹ç¼©å·¥å…·çœŸæ­£åœ°åˆ é™¤è¿™äº›æ²¡æœ‰ç”¨åˆ°çš„ä»£ç ã€‚
åˆ©ç”¨ tree-shakingæŠ€æœ¯ï¼Œå¦‚æœåœ¨é¡¹ç›®ä¸­æ²¡æœ‰å¼•å…¥Transitionã€KeepAlive ç­‰ç»„ä»¶, é‚£ä¹ˆå®ƒä»¬å¯¹åº”çš„ä»£ç å°±ä¸ä¼šæ‰“åŒ…ï¼Œè¿™æ ·ä¹Ÿå°±é—´æ¥è¾¾åˆ°äº†å‡å°‘é¡¹ç›®å¼•å…¥çš„ Vue.js åŒ…ä½“ç§¯çš„ç›®çš„ã€‚</p> <h3 id="æ•°æ®åŠ«æŒä¼˜åŒ–"><a href="#æ•°æ®åŠ«æŒä¼˜åŒ–" class="header-anchor">#</a> æ•°æ®åŠ«æŒä¼˜åŒ–</h3> <ul><li>vue1xä¸vue2xæ˜¯åˆ©ç”¨Object.definePropertyè¿™ä¸ª API å»åŠ«æŒæ•°æ®çš„ getter å’Œ setterï¼š</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// track</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// trigger</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>è¿™ä¸ª API æœ‰ä¸€äº›ç¼ºé™·ï¼Œå®ƒå¿…é¡»é¢„å…ˆçŸ¥é“è¦æ‹¦æˆªçš„ key æ˜¯ä»€ä¹ˆï¼Œå®ƒå¹¶ä¸èƒ½æ£€æµ‹å¯¹è±¡å±æ€§çš„æ·»åŠ å’Œåˆ é™¤ã€‚ä¹‹å‰æä¾›äº† <code>$set</code> å’Œ <code>$delete</code> å®ä¾‹æ–¹æ³•ï¼Œä½†æ˜¯å¢åŠ äº†ä¸€å®šå¯¹è´Ÿæ‹…ã€‚</p> <p>åµŒå¥—å±‚çº§æ¯”è¾ƒæ·±çš„å¯¹è±¡,éœ€è¦é€’å½’éå†æ•´ä¸ªå¯¹è±¡ï¼Œæ‰§è¡Œ Object.defineProperty æŠŠæ¯ä¸€å±‚å¯¹è±¡æ•°æ®éƒ½å˜æˆå“åº”å¼çš„ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token punctuation">{</span>
      b<span class="token operator">:</span> <span class="token punctuation">{</span>
        c<span class="token operator">:</span> <span class="token punctuation">{</span>
          d<span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>Vue.js 3.0 ä½¿ç”¨äº† Proxy API åšæ•°æ®åŠ«æŒ</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> observed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// track</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// trigger</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ProxyåŠ«æŒçš„æ˜¯æ•´ä¸ªå¯¹è±¡ï¼Œè‡ªç„¶å¯¹äºå¯¹è±¡çš„å±æ€§çš„å¢åŠ å’Œåˆ é™¤éƒ½èƒ½æ£€æµ‹åˆ°ï¼ŒProxy APIä¹Ÿä¸èƒ½ç›‘å¬åˆ°å†…éƒ¨æ·±å±‚æ¬¡çš„å¯¹è±¡å˜åŒ–ï¼Œå› æ­¤ Vue.js 3.0 çš„å¤„ç†æ–¹å¼æ˜¯åœ¨ getter ä¸­å»é€’å½’å“åº”å¼ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯çœŸæ­£è®¿é—®åˆ°çš„å†…éƒ¨å¯¹è±¡æ‰ä¼šå˜æˆå“åº”å¼ã€‚</p> <blockquote><p>Proxyçš„ä¼˜åŠ¿</p></blockquote> <ul><li>å¯ç›´æ¥ç›‘å¬æ•°ç»„ç±»å‹çš„æ•°æ®å˜åŒ–</li> <li>ç›‘å¬çš„ç›®æ ‡ä¸ºå¯¹è±¡æœ¬èº«ï¼Œä¸éœ€è¦åƒObject.definePropertyä¸€æ ·éå†æ¯ä¸ªå±æ€§ï¼Œæœ‰ä¸€å®šçš„æ€§èƒ½æå‡</li> <li>å¯æ‹¦æˆªapplyã€ownKeysã€hasç­‰13ç§å¯¹è±¡æ–¹æ³•ï¼Œè€ŒObject.definePropertyä¸è¡Œ</li> <li>ç›´æ¥å®ç°å¯¹è±¡å±æ€§çš„æ–°å¢/åˆ é™¤</li></ul> <h3 id="ç¼–è¯‘ä¼˜åŒ–"><a href="#ç¼–è¯‘ä¼˜åŒ–" class="header-anchor">#</a> ç¼–è¯‘ä¼˜åŒ–</h3> <p>ä¸»è¦ä¼˜åŒ–å‘ç”Ÿåœ¨patché˜¶æ®µï¼Œä¹Ÿå°±æ˜¯diffé˜¶æ®µã€‚</p> <ul><li>vue2.0çš„diffç®—æ³•ä¸æ¨¡ç‰ˆçš„èŠ‚ç‚¹æ•°é‡æ­£ç›¸å…³ï¼Œä¼šé€ æˆå¤§é‡çš„æ€§èƒ½æµªè´¹ã€‚</li> <li>vue3.0çš„diffç®—æ³•ä¸æ¨¡ç‰ˆçš„åŠ¨æ€èŠ‚ç‚¹æ•°æ­£ç›¸å…³ï¼Œé¿å…äº†èµ„æºçš„æµªè´¹ï¼Œå…¶å®ç°åŸç†æ˜¯é€šè¿‡Block treeï¼Œæ‰“è¡¥ä¸æ—¶å°†è·³è¿‡è¿™äº›å±æ€§ä¸ä¼šæ”¹å˜çš„èŠ‚ç‚¹ã€‚</li></ul> <h3 id="é‡æ„-virtual-dom"><a href="#é‡æ„-virtual-dom" class="header-anchor">#</a> é‡æ„ Virtual DOM</h3> <ul><li>æ¨¡æ¿ç¼–è¯‘æ—¶çš„ä¼˜åŒ–ï¼Œå°†ä¸€äº›é™æ€èŠ‚ç‚¹ç¼–è¯‘æˆå¸¸é‡</li> <li>slotä¼˜åŒ–ï¼Œå°†slotç¼–è¯‘ä¸ºlazyå‡½æ•°ï¼Œå°†slotçš„æ¸²æŸ“çš„å†³å®šæƒäº¤ç»™å­ç»„ä»¶</li> <li>æ¨¡æ¿ä¸­å†…è”äº‹ä»¶çš„æå–å¹¶é‡ç”¨ï¼ˆåŸæœ¬æ¯æ¬¡æ¸²æŸ“éƒ½é‡æ–°ç”Ÿæˆå†…è”å‡½æ•°ï¼‰</li></ul> <h3 id="è¯­æ³•-api-ä¼˜åŒ–-composition-api"><a href="#è¯­æ³•-api-ä¼˜åŒ–-composition-api" class="header-anchor">#</a> è¯­æ³• API ä¼˜åŒ–ï¼šComposition API</h3> <ul><li>å¢å¼ºäº†é€»è¾‘å¤ç”¨</li> <li>å¢å¼ºäº†ä»£ç ç»“æ„ä¸å¯è¯»æ€§</li></ul> <h3 id="å–æ¶ˆç»„ä»¶çš„æ ¹èŠ‚ç‚¹"><a href="#å–æ¶ˆç»„ä»¶çš„æ ¹èŠ‚ç‚¹" class="header-anchor">#</a> å–æ¶ˆç»„ä»¶çš„æ ¹èŠ‚ç‚¹</h3> <p>ç”±è€çš„</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å˜æˆä¸º</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>åœ¨åšç»„ä»¶é€’å½’çš„æ—¶å€™å¯ä»¥å‡å°‘<code>div</code>çš„ç”Ÿæˆ</p> <h2 id="æ–°ç‰¹æ€§"><a href="#æ–°ç‰¹æ€§" class="header-anchor">#</a> æ–°ç‰¹æ€§</h2> <h3 id="setup"><a href="#setup" class="header-anchor">#</a> setup</h3> <p>å…¨å±€import</p> <p>vue2ä¸­çš„data,methods,computedéƒ½æ˜¯æŒ‚è½½åœ¨thisä¸Šé¢ï¼Œä¸¤ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹</p> <ol><li>ä¸åˆ©äºç±»å‹æ¨å¯¼</li> <li>æ²¡ç”¨åˆ°computedåŠŸèƒ½ï¼Œä»£ç ä¹Ÿä¼šè¢«æ‰“åŒ…</li></ol> <p>vue3çš„æ‰‹åŠ¨importæ›´åˆ©äºTree-shaking</p> <h3 id="ref"><a href="#ref" class="header-anchor">#</a> ref</h3> <p>reactiveè´Ÿè´£å¤æ‚æ•°æ®ç»“æ„ï¼Œrefå¯ä»¥æŠŠåŸºæœ¬çš„æ•°æ®ç»“æ„åŒ…è£…æˆå“åº”å¼</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>{{state.count}} * 2 = {{double}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>{{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>add<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> method<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      count<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>count<span class="token operator">++</span>
      num <span class="token operator">+=</span> <span class="token number">20</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> double <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'method'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">,</span>
      num<span class="token punctuation">,</span>
      double<span class="token punctuation">,</span>
      add
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="composition-apiåŸç†"><a href="#composition-apiåŸç†" class="header-anchor">#</a> Composition APIåŸç†</h2> <p>vue3.0çš„ <code>compositionApi</code> å’Œ <code>options</code> æ˜¯å…±å­˜çš„ã€‚</p> <h3 id="compositionå’Œoptionså¦‚ä½•åšåˆ°å’Œè°å…±å­˜"><a href="#compositionå’Œoptionså¦‚ä½•åšåˆ°å’Œè°å…±å­˜" class="header-anchor">#</a> compositionå’Œoptionså¦‚ä½•åšåˆ°å’Œè°å…±å­˜ï¼Ÿ</h3> <ul><li>å…³é”®ä»£ç </li></ul> <p>å¦‚æœè®¾ç½®äº†setupå°±ä¼šå…ˆå¤„ç†å®ƒï¼Œelseé€»è¾‘åœ¨åé¢åšã€‚å¦‚æœè®¾ç½®äº†setupåˆ™å…ˆè°ƒç”¨å®ƒï¼Œéšåå†å¤„ç†åˆ«çš„optionsã€‚</p> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/j5DPlP.png" alt="img"></p> <h3 id="setupä¸­çš„thisæŒ‡å‘"><a href="#setupä¸­çš„thisæŒ‡å‘" class="header-anchor">#</a> setupä¸­çš„thisæŒ‡å‘</h3> <p>setupä¸­çš„thiså°±æ˜¯å®ƒæ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ï¼Œå¦‚æœæ˜¯esmæ–¹å¼æ‰“åŒ…ï¼Œä¼šæ˜¯undefinedï¼›å¦‚æœæ˜¯å•æ–‡ä»¶çš„æ–¹å¼è¿è¡Œï¼Œä¼šæ˜¯windowï¼›ä½†æ˜¯ä¸ç®¡æ€æ ·éƒ½æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/my-blog/fontend/vue/core.html" class="prev">
        Vueæ ¸å¿ƒ
      </a></span> <span class="next"><a href="/my-blog/fontend/vue/reactive.html">
        æ•°æ®å“åº”å¼
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-blog/assets/js/app.0ef53e14.js" defer></script><script src="/my-blog/assets/js/2.df0a347f.js" defer></script><script src="/my-blog/assets/js/110.f9a16118.js" defer></script>
  </body>
</html>
