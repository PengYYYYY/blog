<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>组件单元测试 | Super-YUE Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="日常学习和技术积累">
    <link rel="preload" href="/my-blog/assets/css/0.styles.a70fa01a.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.b0cbf800.js" as="script"><link rel="preload" href="/my-blog/assets/js/2.c20646db.js" as="script"><link rel="preload" href="/my-blog/assets/js/31.dfee5411.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/10.73cc9136.js"><link rel="prefetch" href="/my-blog/assets/js/100.4955119e.js"><link rel="prefetch" href="/my-blog/assets/js/101.45a05f3d.js"><link rel="prefetch" href="/my-blog/assets/js/102.ca220187.js"><link rel="prefetch" href="/my-blog/assets/js/103.4a2a6f51.js"><link rel="prefetch" href="/my-blog/assets/js/104.974caabc.js"><link rel="prefetch" href="/my-blog/assets/js/105.983020ae.js"><link rel="prefetch" href="/my-blog/assets/js/106.003307d1.js"><link rel="prefetch" href="/my-blog/assets/js/107.e612ace1.js"><link rel="prefetch" href="/my-blog/assets/js/108.63f9a570.js"><link rel="prefetch" href="/my-blog/assets/js/109.206610e6.js"><link rel="prefetch" href="/my-blog/assets/js/11.3f2a1312.js"><link rel="prefetch" href="/my-blog/assets/js/110.ee8a7580.js"><link rel="prefetch" href="/my-blog/assets/js/111.d1283597.js"><link rel="prefetch" href="/my-blog/assets/js/112.ade03652.js"><link rel="prefetch" href="/my-blog/assets/js/113.1e6f4f20.js"><link rel="prefetch" href="/my-blog/assets/js/114.cb081069.js"><link rel="prefetch" href="/my-blog/assets/js/115.a22e00ed.js"><link rel="prefetch" href="/my-blog/assets/js/116.b188adab.js"><link rel="prefetch" href="/my-blog/assets/js/117.54b20278.js"><link rel="prefetch" href="/my-blog/assets/js/118.bb86c9f2.js"><link rel="prefetch" href="/my-blog/assets/js/12.71d49d35.js"><link rel="prefetch" href="/my-blog/assets/js/13.160560a0.js"><link rel="prefetch" href="/my-blog/assets/js/14.cd51a1fb.js"><link rel="prefetch" href="/my-blog/assets/js/15.56bf6c69.js"><link rel="prefetch" href="/my-blog/assets/js/16.45f38ffe.js"><link rel="prefetch" href="/my-blog/assets/js/17.c5227fff.js"><link rel="prefetch" href="/my-blog/assets/js/18.a47fff11.js"><link rel="prefetch" href="/my-blog/assets/js/19.5aa6838a.js"><link rel="prefetch" href="/my-blog/assets/js/20.d1a5b0a6.js"><link rel="prefetch" href="/my-blog/assets/js/21.20df7757.js"><link rel="prefetch" href="/my-blog/assets/js/22.824ab44f.js"><link rel="prefetch" href="/my-blog/assets/js/23.0572d306.js"><link rel="prefetch" href="/my-blog/assets/js/24.6a1aecc6.js"><link rel="prefetch" href="/my-blog/assets/js/25.b594e67c.js"><link rel="prefetch" href="/my-blog/assets/js/26.b56c48c9.js"><link rel="prefetch" href="/my-blog/assets/js/27.b6a92a17.js"><link rel="prefetch" href="/my-blog/assets/js/28.cdfcff3b.js"><link rel="prefetch" href="/my-blog/assets/js/29.d11cee68.js"><link rel="prefetch" href="/my-blog/assets/js/3.7a51a1dc.js"><link rel="prefetch" href="/my-blog/assets/js/30.7ce447ba.js"><link rel="prefetch" href="/my-blog/assets/js/32.88743ec1.js"><link rel="prefetch" href="/my-blog/assets/js/33.c40639b5.js"><link rel="prefetch" href="/my-blog/assets/js/34.2c9b65e7.js"><link rel="prefetch" href="/my-blog/assets/js/35.63fed2f0.js"><link rel="prefetch" href="/my-blog/assets/js/36.ed9fa68e.js"><link rel="prefetch" href="/my-blog/assets/js/37.ecbbcfdd.js"><link rel="prefetch" href="/my-blog/assets/js/38.06537777.js"><link rel="prefetch" href="/my-blog/assets/js/39.e37717f3.js"><link rel="prefetch" href="/my-blog/assets/js/4.9bf11b2d.js"><link rel="prefetch" href="/my-blog/assets/js/40.dc941512.js"><link rel="prefetch" href="/my-blog/assets/js/41.bb6b3f63.js"><link rel="prefetch" href="/my-blog/assets/js/42.00e6796b.js"><link rel="prefetch" href="/my-blog/assets/js/43.fbb61dc9.js"><link rel="prefetch" href="/my-blog/assets/js/44.84c82e91.js"><link rel="prefetch" href="/my-blog/assets/js/45.0c8d7ba5.js"><link rel="prefetch" href="/my-blog/assets/js/46.c9259703.js"><link rel="prefetch" href="/my-blog/assets/js/47.f5ac59ef.js"><link rel="prefetch" href="/my-blog/assets/js/48.83235619.js"><link rel="prefetch" href="/my-blog/assets/js/49.ff2a9eee.js"><link rel="prefetch" href="/my-blog/assets/js/5.83e5464d.js"><link rel="prefetch" href="/my-blog/assets/js/50.78d915bc.js"><link rel="prefetch" href="/my-blog/assets/js/51.e9a800bf.js"><link rel="prefetch" href="/my-blog/assets/js/52.9bbf04d3.js"><link rel="prefetch" href="/my-blog/assets/js/53.1d8cfec4.js"><link rel="prefetch" href="/my-blog/assets/js/54.26f4c519.js"><link rel="prefetch" href="/my-blog/assets/js/55.ade3b851.js"><link rel="prefetch" href="/my-blog/assets/js/56.d147b161.js"><link rel="prefetch" href="/my-blog/assets/js/57.609c3e6e.js"><link rel="prefetch" href="/my-blog/assets/js/58.f5989cd8.js"><link rel="prefetch" href="/my-blog/assets/js/59.e73f31b7.js"><link rel="prefetch" href="/my-blog/assets/js/6.73f54bd9.js"><link rel="prefetch" href="/my-blog/assets/js/60.0b1e3610.js"><link rel="prefetch" href="/my-blog/assets/js/61.03230814.js"><link rel="prefetch" href="/my-blog/assets/js/62.27bdb301.js"><link rel="prefetch" href="/my-blog/assets/js/63.b73994ab.js"><link rel="prefetch" href="/my-blog/assets/js/64.30edcc1c.js"><link rel="prefetch" href="/my-blog/assets/js/65.b482daf8.js"><link rel="prefetch" href="/my-blog/assets/js/66.8d04c542.js"><link rel="prefetch" href="/my-blog/assets/js/67.492185b5.js"><link rel="prefetch" href="/my-blog/assets/js/68.f04225b8.js"><link rel="prefetch" href="/my-blog/assets/js/69.c52909c3.js"><link rel="prefetch" href="/my-blog/assets/js/7.7016aa5b.js"><link rel="prefetch" href="/my-blog/assets/js/70.1cbcf916.js"><link rel="prefetch" href="/my-blog/assets/js/71.746a78c8.js"><link rel="prefetch" href="/my-blog/assets/js/72.14b85c6b.js"><link rel="prefetch" href="/my-blog/assets/js/73.20445934.js"><link rel="prefetch" href="/my-blog/assets/js/74.7d70f1e9.js"><link rel="prefetch" href="/my-blog/assets/js/75.8c41c856.js"><link rel="prefetch" href="/my-blog/assets/js/76.6e65f257.js"><link rel="prefetch" href="/my-blog/assets/js/77.3efd6f89.js"><link rel="prefetch" href="/my-blog/assets/js/78.3a3a35a5.js"><link rel="prefetch" href="/my-blog/assets/js/79.ea18d37b.js"><link rel="prefetch" href="/my-blog/assets/js/8.b70dcbc1.js"><link rel="prefetch" href="/my-blog/assets/js/80.5630d5fc.js"><link rel="prefetch" href="/my-blog/assets/js/81.2b506686.js"><link rel="prefetch" href="/my-blog/assets/js/82.c9ccc660.js"><link rel="prefetch" href="/my-blog/assets/js/83.8c8b5058.js"><link rel="prefetch" href="/my-blog/assets/js/84.16558ea0.js"><link rel="prefetch" href="/my-blog/assets/js/85.01d661bd.js"><link rel="prefetch" href="/my-blog/assets/js/86.f3bfec91.js"><link rel="prefetch" href="/my-blog/assets/js/87.5b3caf47.js"><link rel="prefetch" href="/my-blog/assets/js/88.80f68c8f.js"><link rel="prefetch" href="/my-blog/assets/js/89.f3dff8e0.js"><link rel="prefetch" href="/my-blog/assets/js/9.c0aec1ed.js"><link rel="prefetch" href="/my-blog/assets/js/90.8df8c8fa.js"><link rel="prefetch" href="/my-blog/assets/js/91.a3ebe084.js"><link rel="prefetch" href="/my-blog/assets/js/92.a2195fab.js"><link rel="prefetch" href="/my-blog/assets/js/93.dd5d666a.js"><link rel="prefetch" href="/my-blog/assets/js/94.a30d524e.js"><link rel="prefetch" href="/my-blog/assets/js/95.b4200bde.js"><link rel="prefetch" href="/my-blog/assets/js/96.3ecbd4b0.js"><link rel="prefetch" href="/my-blog/assets/js/97.24210b4a.js"><link rel="prefetch" href="/my-blog/assets/js/98.dc88a282.js"><link rel="prefetch" href="/my-blog/assets/js/99.d12f0c5a.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.a70fa01a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-blog/" class="home-link router-link-active"><!----> <span class="site-name">Super-YUE Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-blog/zh/fontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/my-blog/zh/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/my-blog/zh/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/my-blog/zh/articles/" class="nav-link router-link-active">
  文章
</a></div><div class="nav-item"><a href="/my-blog/zh/network/" class="nav-link">
  网络
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-blog/zh/fontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/my-blog/zh/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/my-blog/zh/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/my-blog/zh/articles/" class="nav-link router-link-active">
  文章
</a></div><div class="nav-item"><a href="/my-blog/zh/network/" class="nav-link">
  网络
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>工程与实践</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-blog/zh/articles/engineering/engineering.html" class="sidebar-link">工程化思考</a></li><li><a href="/my-blog/zh/articles/engineering/siskinImport.html" class="sidebar-link">组件库之按需加载</a></li><li><a href="/my-blog/zh/articles/engineering/siskinStyle.html" class="sidebar-link">组件库之样式包</a></li><li><a href="/my-blog/zh/articles/engineering/unitTest.html" aria-current="page" class="active sidebar-link">组件单元测试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/zh/articles/engineering/unitTest.html#为什么要做单元测试" class="sidebar-link">为什么要做单元测试</a></li><li class="sidebar-sub-header"><a href="/my-blog/zh/articles/engineering/unitTest.html#单元测试主要类型" class="sidebar-link">单元测试主要类型</a></li><li class="sidebar-sub-header"><a href="/my-blog/zh/articles/engineering/unitTest.html#单元测试的局限和问题" class="sidebar-link">单元测试的局限和问题</a></li><li class="sidebar-sub-header"><a href="/my-blog/zh/articles/engineering/unitTest.html#测试覆盖率" class="sidebar-link">测试覆盖率</a></li><li class="sidebar-sub-header"><a href="/my-blog/zh/articles/engineering/unitTest.html#实践" class="sidebar-link">实践</a></li><li class="sidebar-sub-header"><a href="/my-blog/zh/articles/engineering/unitTest.html#结论" class="sidebar-link">结论</a></li></ul></li><li><a href="/my-blog/zh/articles/engineering/buildSystem.html" class="sidebar-link">关于活动搭建系统的思考</a></li><li><a href="/my-blog/zh/articles/engineering/bridge.html" class="sidebar-link">JSBridge</a></li><li><a href="/my-blog/zh/articles/engineering/mp.html" class="sidebar-link">小程序原理</a></li><li><a href="/my-blog/zh/articles/engineering/jwt.html" class="sidebar-link">jwt与session-cookie</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>javaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>杂七杂八的</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>个人思考</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="组件单元测试"><a href="#组件单元测试" class="header-anchor">#</a> 组件单元测试</h1> <p>做组件库的时候，老板要求写单元测试，于是就整起了。</p> <h2 id="为什么要做单元测试"><a href="#为什么要做单元测试" class="header-anchor">#</a> 为什么要做单元测试</h2> <ul><li>提供描述组件行为的文档（看开源项目可以从单元测试看起）</li> <li>节省手动测试的时间</li> <li>有利于平稳升级</li> <li>改进组件设计</li> <li>有助于代码重用</li></ul> <h2 id="单元测试主要类型"><a href="#单元测试主要类型" class="header-anchor">#</a> 单元测试主要类型</h2> <ul><li>展示型业务组件</li> <li>功能型组件</li></ul> <h3 id="展示型测试"><a href="#展示型测试" class="header-anchor">#</a> 展示型测试</h3> <ul><li>class 类的判断</li> <li>样式的判读（如颜色，位置等）</li></ul> <h3 id="功能型测试"><a href="#功能型测试" class="header-anchor">#</a> 功能型测试</h3> <ul><li>Props传入</li> <li>组件分支渲染逻辑</li> <li>事件调用和参数传递</li></ul> <h2 id="单元测试的局限和问题"><a href="#单元测试的局限和问题" class="header-anchor">#</a> 单元测试的局限和问题</h2> <ul><li>测试逻辑基本没什么问题，但是UI呈现上还得人肉测试。</li> <li>编写麻烦，可能组件写10分钟，单元测试得写20分钟，增加了开发成本。</li></ul> <p>所以单元测试在业务需求中基本上不会有，主要应用在编写代码库中。</p> <h2 id="测试覆盖率"><a href="#测试覆盖率" class="header-anchor">#</a> 测试覆盖率</h2> <p>测试覆盖率则是衡量测试完整性的一种手段：通过已执行代码的覆盖率，用于评测代码的可靠性和稳定性，可以及时发现没有被测试用例执行到的代码块，提前发现可能的逻辑错误。</p> <p>伊斯坦布尔（以下简称 Istanbul）是一个基于 JavaScript 的测试覆盖率统计工具，目前绝大多数测试框架比如 jest mocha 等都是使用 Istanbul 来统计覆盖率的。</p> <p>覆盖率维度:</p> <ul><li>Statements: 语句覆盖率，所有语句的执行率；</li> <li>Branches: 分支覆盖率，所有代码分支如 if、三目运算的执行率；</li> <li>Functions: 函数覆盖率，所有函数的被调用率；</li> <li>Lines: 行覆盖率，所有有效代码行的执行率，和语句类似，但是计算方式略有差别；</li></ul> <h2 id="实践"><a href="#实践" class="header-anchor">#</a> 实践</h2> <p>使用到的库</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>@vue<span class="token operator">/</span>test<span class="token operator">-</span>utils<span class="token punctuation">,</span> @vue<span class="token operator">/</span>server<span class="token operator">-</span>test<span class="token operator">-</span>utils<span class="token punctuation">,</span> jest<span class="token punctuation">,</span> jest<span class="token operator">-</span>html<span class="token operator">-</span>reporter<span class="token punctuation">,</span> jest<span class="token operator">-</span>serializer<span class="token operator">-</span>vue<span class="token punctuation">,</span> vue<span class="token operator">-</span>jest<span class="token punctuation">,</span> sinon<span class="token punctuation">,</span> sinon<span class="token operator">-</span>chai
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// jest.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    setupFiles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'&lt;rootDir&gt;/test/jest.init.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    moduleFileExtensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    transform<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">'^.+\\.js$'</span><span class="token operator">:</span> <span class="token string">'babel-jest'</span><span class="token punctuation">,</span>
        <span class="token string">'.*\\.(vue)$'</span><span class="token operator">:</span> <span class="token string">'vue-jest'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    testEnvironment<span class="token operator">:</span> <span class="token string">'jsdom'</span><span class="token punctuation">,</span>
    modulePaths<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'&lt;rootDir&gt;/src'</span><span class="token punctuation">,</span>
        <span class="token string">'&lt;rootDir&gt;/node_modules'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    moduleNameMapper<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">'siskin'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;rootDir&gt;/src/index</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    snapshotSerializers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'jest-serializer-vue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    testURL<span class="token operator">:</span> <span class="token string">'http://localhost/'</span><span class="token punctuation">,</span>
    collectCoverage<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    coverageDirectory<span class="token operator">:</span> <span class="token string">'&lt;rootDir&gt;/test/coverage'</span><span class="token punctuation">,</span>
    coverageReporters<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'html'</span><span class="token punctuation">,</span> <span class="token string">'lcov'</span><span class="token punctuation">,</span> <span class="token string">'text-summary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    testPathIgnorePatterns<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'&lt;rootDir&gt;/build'</span><span class="token punctuation">,</span> <span class="token string">'&lt;rootDir&gt;/test/e2e'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    collectCoverageFrom<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'packages/*/*.{js,vue}'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    coverageThreshold<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">'global'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'branches'</span><span class="token operator">:</span> <span class="token number">90</span><span class="token punctuation">,</span>
            <span class="token string">'functions'</span><span class="token operator">:</span> <span class="token number">95</span><span class="token punctuation">,</span>
            <span class="token string">'lines'</span><span class="token operator">:</span> <span class="token number">95</span><span class="token punctuation">,</span>
            <span class="token string">'statements'</span><span class="token operator">:</span> <span class="token number">95</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    reporters<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'default'</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>
            <span class="token string">'&lt;rootDir&gt;/node_modules/jest-html-reporter'</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                pageTitle<span class="token operator">:</span> <span class="token string">'tc-siskin-test'</span><span class="token punctuation">,</span>
                includeFailureMsg<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                outputPath<span class="token operator">:</span> <span class="token string">'&lt;rootDir&gt;/test/test-report.html'</span><span class="token punctuation">,</span>
                includeConsoleLog<span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>配置参数：</p> <ul><li>setupFiles:初始化文件</li> <li>moduleFileExtensions: 文件类型</li> <li>transform：文件转换配置</li> <li>testEnvironment：测试环境</li> <li>moduleNameMapper: 测试包名</li> <li>snapshotSerializers：快照配置（通过快照可以对比前后的dom节点变化）</li> <li>collectCoverage：测试覆盖率相关配置</li> <li>reporters：测试报告</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// jest.init.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> pkg <span class="token keyword">from</span> <span class="token string">'../package.json'</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>silent <span class="token operator">=</span> <span class="token boolean">true</span>

global<span class="token punctuation">.</span><span class="token constant">MAN_VERSION</span> <span class="token operator">=</span> pkg<span class="token punctuation">.</span>version

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="一个inputnumber组件的单元测试编写"><a href="#一个inputnumber组件的单元测试编写" class="header-anchor">#</a> 一个InputNumber组件的单元测试编写</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> sinon <span class="token keyword">from</span> <span class="token string">'sinon'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
    mount
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
    InputNumber
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'tc-flight-siskin'</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'InputNumber-Operation'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        wrapper <span class="token operator">&amp;&amp;</span> wrapper<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> wrapper
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'InputNumber default'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">0</span>
        wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>InputNumber<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            propsData<span class="token operator">:</span> <span class="token punctuation">{</span>
                value<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            listeners<span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token function">input</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    value <span class="token operator">=</span> val
                    wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        value
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> eventSpy <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">spy</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">,</span> <span class="token string">'$emit'</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> InputNumberMinus <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.sis-input-number-minus'</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> InputNumberPlus <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.sis-input-number-plus'</span><span class="token punctuation">)</span>
        
        <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">props</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>min<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">props</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>max<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span>

        InputNumberMinus<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>eventSpy<span class="token punctuation">.</span><span class="token function">calledWith</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        InputNumberPlus<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>eventSpy<span class="token punctuation">.</span><span class="token function">calledWith</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        InputNumberMinus<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

        eventSpy<span class="token punctuation">.</span><span class="token function">resetHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        InputNumberMinus<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>eventSpy<span class="token punctuation">.</span><span class="token function">calledWith</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'InputNumber with range'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">8</span>
        wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>InputNumber<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            propsData<span class="token operator">:</span> <span class="token punctuation">{</span>
                value<span class="token punctuation">,</span>
                max<span class="token operator">:</span> <span class="token number">5</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            listeners<span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token function">input</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    value <span class="token operator">=</span> val
                    wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        value
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> eventSpy <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">spy</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">,</span> <span class="token string">'$emit'</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> InputNumberMinus <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.sis-input-number-minus'</span><span class="token punctuation">)</span>
        InputNumberMinus<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>eventSpy<span class="token punctuation">.</span><span class="token function">calledWith</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'InputNumber with range'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">0</span>
        wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>InputNumber<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            propsData<span class="token operator">:</span> <span class="token punctuation">{</span>
                value<span class="token punctuation">,</span>
                min<span class="token operator">:</span> <span class="token number">2</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            listeners<span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token function">input</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    value <span class="token operator">=</span> val
                    wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        value
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> eventSpy <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">spy</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">,</span> <span class="token string">'$emit'</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> InputNumberPlus <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.sis-input-number-plus'</span><span class="token punctuation">)</span>
        InputNumberPlus<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>eventSpy<span class="token punctuation">.</span><span class="token function">calledWith</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br></div></div><h3 id="公共函数的单元测试代码"><a href="#公共函数的单元测试代码" class="header-anchor">#</a> 公共函数的单元测试代码</h3> <p>级联选择器的一些公共方法，通过单元测试可以很快知道这几个方法的用途。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// picker.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
 cascadeDataToNormalDataWithDefault<span class="token punctuation">,</span>
 cascadeDataToNormalData<span class="token punctuation">,</span>
 getDefaultVal<span class="token punctuation">,</span>
 getDefaultDateVal<span class="token punctuation">,</span>
 getunitdaymark
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../picker'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
 padStart
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../index'</span>

<span class="token keyword">const</span> nomalData <span class="token operator">=</span> <span class="token punctuation">[</span>
 <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> cascadeData <span class="token operator">=</span> <span class="token punctuation">[</span>
 <span class="token punctuation">{</span>
   value<span class="token operator">:</span> <span class="token string">'A'</span><span class="token punctuation">,</span>
   children<span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'A-a'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'A-b'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'A-c'</span> <span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">{</span>
   value<span class="token operator">:</span> <span class="token string">'B'</span><span class="token punctuation">,</span>
   children<span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'B-a'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'B-b'</span> <span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2020-03-01 11:11:11'</span><span class="token punctuation">)</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'utils-test'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'cascadeDataToNormalData'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;base&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cascadeDataToNormalData</span><span class="token punctuation">(</span>cascadeData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;A-a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A-b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A-c&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'cascadeDataToNormalData'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;base&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cascadeDataToNormalDataWithDefault</span><span class="token punctuation">(</span>cascadeData<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;A-a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A-b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A-c&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'getDefaultVal'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;base&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getDefaultVal</span><span class="token punctuation">(</span>nomalData<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>value<span class="token operator">:</span><span class="token string">'A'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>value<span class="token operator">:</span><span class="token string">'d'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'getDefaultDateVal'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getDefaultDateVal</span><span class="token punctuation">(</span><span class="token string">'date'</span><span class="token punctuation">,</span> date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
     <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'2020年'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'3月'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'1日'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;date-time&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getDefaultDateVal</span><span class="token punctuation">(</span><span class="token string">'date-time'</span><span class="token punctuation">,</span> date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'3月1日'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'11点'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'11分'</span> <span class="token punctuation">}</span>
   <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getDefaultDateVal</span><span class="token punctuation">(</span><span class="token string">'time'</span><span class="token punctuation">,</span> date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'11时'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'11分'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'11秒'</span> <span class="token punctuation">}</span>
   <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getDefaultDateVal</span><span class="token punctuation">(</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">padStart</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">时</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">padStart</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">分</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">padStart</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">秒</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>
   <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'getunitdaymark'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;base&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getunitdaymark</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;今天&quot;</span><span class="token punctuation">)</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getunitdaymark</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;昨天&quot;</span><span class="token punctuation">)</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getunitdaymark</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;明天&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br></div></div><h3 id="结果"><a href="#结果" class="header-anchor">#</a> 结果</h3> <blockquote><p>覆盖率报告</p></blockquote> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/riM06e.png" alt="img"></p> <blockquote><p>测试报告</p></blockquote> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/R7TxH8.png" alt="img"></p> <h2 id="结论"><a href="#结论" class="header-anchor">#</a> 结论</h2> <p>写单元测试还是蛮有意义的，一开始可能会觉得没什么意思很无聊，但是他确实可以站在工程的角度上来审视你写的代码。让你的代码更加严谨规范，在提一些开源项目的PR的时候，通常都需要写单元测试，来保证你代码的质量。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/my-blog/zh/articles/engineering/siskinStyle.html" class="prev">
        组件库之样式包
      </a></span> <span class="next"><a href="/my-blog/zh/articles/engineering/buildSystem.html">
        关于活动搭建系统的思考
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-blog/assets/js/app.b0cbf800.js" defer></script><script src="/my-blog/assets/js/2.c20646db.js" defer></script><script src="/my-blog/assets/js/31.dfee5411.js" defer></script>
  </body>
</html>
