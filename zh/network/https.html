<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>https | Super-YUE Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="日常学习和技术积累">
    <link rel="preload" href="/my-blog/assets/css/0.styles.a70fa01a.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.68e31997.js" as="script"><link rel="preload" href="/my-blog/assets/js/2.c20646db.js" as="script"><link rel="preload" href="/my-blog/assets/js/130.f37c3a38.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/10.52811631.js"><link rel="prefetch" href="/my-blog/assets/js/100.278077e0.js"><link rel="prefetch" href="/my-blog/assets/js/101.b9469f8a.js"><link rel="prefetch" href="/my-blog/assets/js/102.90581d97.js"><link rel="prefetch" href="/my-blog/assets/js/103.ab7f1b36.js"><link rel="prefetch" href="/my-blog/assets/js/104.1c1d4805.js"><link rel="prefetch" href="/my-blog/assets/js/105.56bb8764.js"><link rel="prefetch" href="/my-blog/assets/js/106.8f5a4856.js"><link rel="prefetch" href="/my-blog/assets/js/107.fd113611.js"><link rel="prefetch" href="/my-blog/assets/js/108.dd4b3c84.js"><link rel="prefetch" href="/my-blog/assets/js/109.44393c31.js"><link rel="prefetch" href="/my-blog/assets/js/11.e751ad22.js"><link rel="prefetch" href="/my-blog/assets/js/110.5f9edb31.js"><link rel="prefetch" href="/my-blog/assets/js/111.51aa825f.js"><link rel="prefetch" href="/my-blog/assets/js/112.0a3aac9a.js"><link rel="prefetch" href="/my-blog/assets/js/113.be324074.js"><link rel="prefetch" href="/my-blog/assets/js/114.f65b0835.js"><link rel="prefetch" href="/my-blog/assets/js/115.dc9fbd90.js"><link rel="prefetch" href="/my-blog/assets/js/116.225295f8.js"><link rel="prefetch" href="/my-blog/assets/js/117.996e03ed.js"><link rel="prefetch" href="/my-blog/assets/js/118.866383c4.js"><link rel="prefetch" href="/my-blog/assets/js/119.4d123213.js"><link rel="prefetch" href="/my-blog/assets/js/12.0400ff5a.js"><link rel="prefetch" href="/my-blog/assets/js/120.7d809b9b.js"><link rel="prefetch" href="/my-blog/assets/js/121.7f2da05f.js"><link rel="prefetch" href="/my-blog/assets/js/122.09e05a8a.js"><link rel="prefetch" href="/my-blog/assets/js/123.cddeedda.js"><link rel="prefetch" href="/my-blog/assets/js/124.59ab2e0a.js"><link rel="prefetch" href="/my-blog/assets/js/125.9d241899.js"><link rel="prefetch" href="/my-blog/assets/js/126.24db340e.js"><link rel="prefetch" href="/my-blog/assets/js/127.dafdbcfc.js"><link rel="prefetch" href="/my-blog/assets/js/128.20b7f4cd.js"><link rel="prefetch" href="/my-blog/assets/js/129.7c7ae113.js"><link rel="prefetch" href="/my-blog/assets/js/13.2a931ddf.js"><link rel="prefetch" href="/my-blog/assets/js/131.205d6255.js"><link rel="prefetch" href="/my-blog/assets/js/132.3babc2f7.js"><link rel="prefetch" href="/my-blog/assets/js/133.70dff89c.js"><link rel="prefetch" href="/my-blog/assets/js/14.e8f09f17.js"><link rel="prefetch" href="/my-blog/assets/js/15.8d96ba11.js"><link rel="prefetch" href="/my-blog/assets/js/16.9fa47495.js"><link rel="prefetch" href="/my-blog/assets/js/17.a14d223c.js"><link rel="prefetch" href="/my-blog/assets/js/18.dc9ab091.js"><link rel="prefetch" href="/my-blog/assets/js/19.e4fd3365.js"><link rel="prefetch" href="/my-blog/assets/js/20.2705c997.js"><link rel="prefetch" href="/my-blog/assets/js/21.b7ac9ffe.js"><link rel="prefetch" href="/my-blog/assets/js/22.7e9e70d4.js"><link rel="prefetch" href="/my-blog/assets/js/23.0904080b.js"><link rel="prefetch" href="/my-blog/assets/js/24.34fcef1c.js"><link rel="prefetch" href="/my-blog/assets/js/25.966d0014.js"><link rel="prefetch" href="/my-blog/assets/js/26.16966ceb.js"><link rel="prefetch" href="/my-blog/assets/js/27.b9f8f4f4.js"><link rel="prefetch" href="/my-blog/assets/js/28.ac9cf494.js"><link rel="prefetch" href="/my-blog/assets/js/29.0e57eeee.js"><link rel="prefetch" href="/my-blog/assets/js/3.fb5d808e.js"><link rel="prefetch" href="/my-blog/assets/js/30.49ce2aa8.js"><link rel="prefetch" href="/my-blog/assets/js/31.6efaa5ab.js"><link rel="prefetch" href="/my-blog/assets/js/32.67da77e1.js"><link rel="prefetch" href="/my-blog/assets/js/33.6bef488e.js"><link rel="prefetch" href="/my-blog/assets/js/34.352f7b56.js"><link rel="prefetch" href="/my-blog/assets/js/35.5e84ca31.js"><link rel="prefetch" href="/my-blog/assets/js/36.8e776856.js"><link rel="prefetch" href="/my-blog/assets/js/37.8e2f1c56.js"><link rel="prefetch" href="/my-blog/assets/js/38.50764a51.js"><link rel="prefetch" href="/my-blog/assets/js/39.de4ff313.js"><link rel="prefetch" href="/my-blog/assets/js/4.9bf11b2d.js"><link rel="prefetch" href="/my-blog/assets/js/40.5a5ead7a.js"><link rel="prefetch" href="/my-blog/assets/js/41.e974048a.js"><link rel="prefetch" href="/my-blog/assets/js/42.4b7db7a0.js"><link rel="prefetch" href="/my-blog/assets/js/43.dd9f06a4.js"><link rel="prefetch" href="/my-blog/assets/js/44.f2dd322a.js"><link rel="prefetch" href="/my-blog/assets/js/45.d0e62e8c.js"><link rel="prefetch" href="/my-blog/assets/js/46.9f546151.js"><link rel="prefetch" href="/my-blog/assets/js/47.d16d23a6.js"><link rel="prefetch" href="/my-blog/assets/js/48.bbc21311.js"><link rel="prefetch" href="/my-blog/assets/js/49.4c9a1439.js"><link rel="prefetch" href="/my-blog/assets/js/5.83e5464d.js"><link rel="prefetch" href="/my-blog/assets/js/50.c3e9a09f.js"><link rel="prefetch" href="/my-blog/assets/js/51.56e29e1d.js"><link rel="prefetch" href="/my-blog/assets/js/52.3a6df694.js"><link rel="prefetch" href="/my-blog/assets/js/53.a0b28f9b.js"><link rel="prefetch" href="/my-blog/assets/js/54.e2f6ae46.js"><link rel="prefetch" href="/my-blog/assets/js/55.5f07e4aa.js"><link rel="prefetch" href="/my-blog/assets/js/56.85dbb573.js"><link rel="prefetch" href="/my-blog/assets/js/57.b897f1f0.js"><link rel="prefetch" href="/my-blog/assets/js/58.ff4816f6.js"><link rel="prefetch" href="/my-blog/assets/js/59.1e1f0a03.js"><link rel="prefetch" href="/my-blog/assets/js/6.6606f5bf.js"><link rel="prefetch" href="/my-blog/assets/js/60.02994d47.js"><link rel="prefetch" href="/my-blog/assets/js/61.efa3df43.js"><link rel="prefetch" href="/my-blog/assets/js/62.00adcc57.js"><link rel="prefetch" href="/my-blog/assets/js/63.1768a94c.js"><link rel="prefetch" href="/my-blog/assets/js/64.de78d68e.js"><link rel="prefetch" href="/my-blog/assets/js/65.2d20a7bb.js"><link rel="prefetch" href="/my-blog/assets/js/66.54135e74.js"><link rel="prefetch" href="/my-blog/assets/js/67.16620b2d.js"><link rel="prefetch" href="/my-blog/assets/js/68.bdda48ff.js"><link rel="prefetch" href="/my-blog/assets/js/69.a8885a2c.js"><link rel="prefetch" href="/my-blog/assets/js/7.c24d302d.js"><link rel="prefetch" href="/my-blog/assets/js/70.2111e96a.js"><link rel="prefetch" href="/my-blog/assets/js/71.8b22ed02.js"><link rel="prefetch" href="/my-blog/assets/js/72.f4f1eab6.js"><link rel="prefetch" href="/my-blog/assets/js/73.ddb8a35c.js"><link rel="prefetch" href="/my-blog/assets/js/74.d14fa93b.js"><link rel="prefetch" href="/my-blog/assets/js/75.efd8d645.js"><link rel="prefetch" href="/my-blog/assets/js/76.8f7c6419.js"><link rel="prefetch" href="/my-blog/assets/js/77.438fbb4f.js"><link rel="prefetch" href="/my-blog/assets/js/78.78eabd48.js"><link rel="prefetch" href="/my-blog/assets/js/79.f6dbe850.js"><link rel="prefetch" href="/my-blog/assets/js/8.054b3948.js"><link rel="prefetch" href="/my-blog/assets/js/80.d62f664e.js"><link rel="prefetch" href="/my-blog/assets/js/81.1d956933.js"><link rel="prefetch" href="/my-blog/assets/js/82.8c60dc1b.js"><link rel="prefetch" href="/my-blog/assets/js/83.d23aff92.js"><link rel="prefetch" href="/my-blog/assets/js/84.fb65bc21.js"><link rel="prefetch" href="/my-blog/assets/js/85.7521ce15.js"><link rel="prefetch" href="/my-blog/assets/js/86.d0eae19f.js"><link rel="prefetch" href="/my-blog/assets/js/87.d2fcac60.js"><link rel="prefetch" href="/my-blog/assets/js/88.07ecfee8.js"><link rel="prefetch" href="/my-blog/assets/js/89.c20eb426.js"><link rel="prefetch" href="/my-blog/assets/js/9.4cd1edf4.js"><link rel="prefetch" href="/my-blog/assets/js/90.14a18fbe.js"><link rel="prefetch" href="/my-blog/assets/js/91.adc68fdd.js"><link rel="prefetch" href="/my-blog/assets/js/92.8dd52840.js"><link rel="prefetch" href="/my-blog/assets/js/93.a9edd5c6.js"><link rel="prefetch" href="/my-blog/assets/js/94.3700049e.js"><link rel="prefetch" href="/my-blog/assets/js/95.2839d5eb.js"><link rel="prefetch" href="/my-blog/assets/js/96.48f53911.js"><link rel="prefetch" href="/my-blog/assets/js/97.3fd71a9f.js"><link rel="prefetch" href="/my-blog/assets/js/98.69caf868.js"><link rel="prefetch" href="/my-blog/assets/js/99.f0cab62d.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.a70fa01a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-blog/" class="home-link router-link-active"><!----> <span class="site-name">Super-YUE Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-blog/zh/fontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/my-blog/zh/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/my-blog/zh/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/my-blog/zh/articles/" class="nav-link">
  文章
</a></div><div class="nav-item"><a href="/my-blog/zh/network/" class="nav-link router-link-active">
  网络
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-blog/zh/fontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/my-blog/zh/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/my-blog/zh/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/my-blog/zh/articles/" class="nav-link">
  文章
</a></div><div class="nav-item"><a href="/my-blog/zh/network/" class="nav-link router-link-active">
  网络
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/my-blog/zh/network/connectionProcess.html" class="sidebar-link">网络连接过程</a></li><li><a href="/my-blog/zh/network/crossDomain.html" class="sidebar-link">跨域</a></li><li><a href="/my-blog/zh/network/httpCode.html" class="sidebar-link">http code</a></li><li><a href="/my-blog/zh/network/security.html" class="sidebar-link">安全</a></li><li><a href="/my-blog/zh/network/http.html" class="sidebar-link">http</a></li><li><a href="/my-blog/zh/network/https.html" aria-current="page" class="active sidebar-link">https</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/zh/network/https.html#为什么有https" class="sidebar-link">为什么有https</a></li><li class="sidebar-sub-header"><a href="/my-blog/zh/network/https.html#加密方法" class="sidebar-link">加密方法</a></li><li class="sidebar-sub-header"><a href="/my-blog/zh/network/https.html#https-的加密流程" class="sidebar-link">HTTPS 的加密流程</a></li></ul></li><li><a href="/my-blog/zh/network/http-next.html" class="sidebar-link">http-next</a></li><li><a href="/my-blog/zh/network/cache.html" class="sidebar-link">缓存</a></li><li><a href="/my-blog/zh/network/network-question.html" class="sidebar-link">常见的网络问题</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="https"><a href="#https" class="header-anchor">#</a> https</h1> <p>SSL(Secure Socket Layer)安全套接层
TLS(Transport Layer Security)安全层传输协议</p> <h2 id="为什么有https"><a href="#为什么有https" class="header-anchor">#</a> 为什么有https</h2> <p>http的不足</p> <ul><li>通信使用明文(不加密)，内容可能会被窃听</li> <li>不验证通信方的身份，因此有可能遭遇伪装</li> <li>无法证明报文的完整性，所以有可能已遭篡改</li></ul> <p>https 就是加了一层ssl的http。</p> <p>报文首部不会被加密，报文主体会被加密。</p> <h2 id="加密方法"><a href="#加密方法" class="header-anchor">#</a> 加密方法</h2> <p>SSL 采用一种叫做公开密钥加密(Public-key cryptography)的加密处理方式。</p> <p>近代的加密方法中加密算法是公开的，而密钥是保密的。通过这种方式得以保持加密方法的安全性。加密和解密都会用到密钥。没有密钥就无法对密码解密，反过来说，任何人只要持有密钥就能解密了。如果密钥被攻击者获得，那加密也就失去了意义。</p> <h3 id="共享密钥加密"><a href="#共享密钥加密" class="header-anchor">#</a> 共享密钥加密</h3> <p>加密和解密同用一个密钥的方式称为共享密钥加密(Common key crypto system)，也被叫做对称密钥加密。</p> <p>以共享密钥方式加密时必须将密钥也发给对方。在互联网上转发密钥时，如果通信被监听那么密钥就可会落入攻击者之手，同时也就失去了加密的意义。另外还得设法安全地保管接收到的密钥。</p> <h3 id="使用两把密钥的公开密钥加密"><a href="#使用两把密钥的公开密钥加密" class="header-anchor">#</a> 使用两把密钥的公开密钥加密</h3> <p>公开密钥加密使用一对非对称的密钥。一把叫做私有密钥 (private key)，另一把叫做公开密钥(public key)。私有密钥不能让其他任何人知道，而公开密钥则可以随意发布，任何人都可以获得。使用公开密钥加密方式，发送密文的一方使用对方公开密钥进行加密处理，对方收到被加密的信息后，再使用自己的私有密钥进行解密。</p> <h3 id="混合加密方式"><a href="#混合加密方式" class="header-anchor">#</a> 混合加密方式</h3> <p>HTTPS 采用共享密钥加密和公开密钥加密两者并用的混合加密机制。若密钥能够实现安全交换，那么有可能会考虑仅使用公开密钥加密来通信。但是公开密钥加密与共享密钥加密相比，其处理速度要慢。</p> <h3 id="证明公开密钥正确性的证书"><a href="#证明公开密钥正确性的证书" class="header-anchor">#</a> 证明公开密钥正确性的证书</h3> <p>公开密钥加密方式无法证明公开密钥本身就是货真价实的公开密钥，使用由数字证书认证机构(CA，Certificate Authority)和其相关机关颁发的公开密钥证书。</p> <p>公钥证书也可叫做数字证书或直接称为证书。接到证书的客户端可使用数字证书认证机构的公开密钥，对那张证书上的数字签名进行验证，一旦验证通过，客户端便可明确两件事:</p> <ul><li>认证服务器的公开密钥的是真实有效的数字证书认证机构。</li> <li>服务器的公开密钥是值得信赖的。</li></ul> <h3 id="https的通信机制"><a href="#https的通信机制" class="header-anchor">#</a> https的通信机制</h3> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/QpC7V4.png" alt="img"></p> <ol><li>客户端通过发送 Client Hello 报文开始 SSL 通信。报文中包含客户端支持的 SSL 的指定版本、加密组件(Cipher Suite)列表(所使用的加密算法及密钥长度等)。</li> <li>服务器可进行 SSL 通信时，会以 Server Hello 报文作为应答。和客户端一样，在报文中包含 SSL 版本以及加密组件。服务器的加密组件内容是从接收到的客户端加密组件内筛选出来的。</li> <li>之后服务器发送 Certificate 报文。报文中包含公开密钥证书。</li> <li>最后服务器发送 Server Hello Done 报文通知客户端，最初阶段的 SSL 握手协商部分结束。</li> <li>SSL 第一次握手结束之后，客户端以 Client Key Exchange 报文作为回应。报文中包含通信加密中使用的一种被称为 Pre-master secret 的随机密码串。该报文已用步骤 3 中的公开密钥进行加密。</li> <li>接着客户端继续发送 Change Cipher Spec 报文。该报文会提示服务器，在此报文之后的通信会采用 Pre-master secret 密钥加密。</li> <li>客户端发送 Finished 报文。该报文包含连接至今全部报文的整体校验值。这次握手协商是否能够成功，要以服务器是否能够正确解密该报文作为判定标准。</li> <li>服务器同样发送 Change Cipher Spec 报文。</li> <li>服务器同样发送 Finished 报文。</li> <li>服务器和客户端的 Finished 报文交换完毕之后，SSL 连接 就算建立完成。当然，通信会受到 SSL 的保护。从此处开始进行应用 层协议的通信，即发送 HTTP 请求。</li> <li>应用层协议通信，即发送 HTTP 响应。</li> <li>最后由客户端断开连接。断开连接时，发送 close_notify 报 文。上图做了一些省略，这步之后再发送 TCP FIN 报文来关闭与 TCP 的通信。</li></ol> <p>HTTPS 使用 SSL(Secure Socket Layer) 和 TLS(Transport Layer Security)这两个协议。
SSL 技术最初是由浏览器开发商网景通信公司率先倡导的，开发过 SSL3.0 之前的版本。目前主导权已转移到 IETF(Internet Engineering Task Force，Internet 工程任务组)的手中。
IETF 以 SSL3.0 为基准，后又制定了 TLS1.0、TLS1.1 和 TLS1.2。TSL 是以 SSL 为原型开发的协议，有时会统一称该协议 为 SSL。当前主流的版本是 SSL3.0 和 TLS1.0。
由于 SSL1.0 协议在设计之初被发现出了问题，就没有实际投入 使用。SSL2.0 也被发现存在问题，所以很多浏览器直接废除了该协议版本。</p> <h3 id="https比http要慢2到100倍"><a href="#https比http要慢2到100倍" class="header-anchor">#</a> HTTPS比HTTP要慢2到100倍</h3> <p><img src="https://gitee.com/PENG_YUE/myImg/raw/master/uPic/sPakpp.png" alt="img"></p> <ul><li>通信慢</li> <li>消耗大量CPU 及内存等资源，导致处理速度变慢。</li> <li>SSL 必须进行加密处理。在服务器和客户端都需要进行 加密和解密的运算处理。因此从结果上讲，比起 HTTP 会更多地消耗服务器和客户端的硬件资源，导致负载增强。</li></ul> <h2 id="https-的加密流程"><a href="#https-的加密流程" class="header-anchor">#</a> HTTPS 的加密流程</h2> <p>两个概念:</p> <ol><li>对称加密：加密和解密的秘钥使用的是同一个.</li> <li>非对称加密：使用两把密钥，一把公钥（publickey）和私钥（privatekey）。</li> <li>Hash算法（摘要算法）：用户可以通过hash算法对目标信息生成一段特定长度的唯一hash值，却不能通过这个hash值重新获得目标信息。（jwt）</li></ol> <p>数据通过对称加密的方式来加密，对称加密的密钥是由客户端生成的随机字符串来充当，再通过非对称加密的方式加密后传递到服务端。</p> <p>https的三次握手：</p> <ul><li>服务端发送公钥到客户端</li></ul> <p>服务端将公钥以证书的形式发送给客户端，证书内包含服务器端的公钥，证书颁发机构，证书有效期，服务端域名等信息。</p> <ul><li>客户端对证书进行校验并且向服务端发送对称密钥</li></ul> <p>客户端收到证书后，会选择是否信任证书，这里是否信任可以根据域名，颁发机构，有效期等信息来判断，如果证书校验不通过，就给予风险提示并断开连接；如果校验通过，就生成一个随机数，用作对称加密的密钥，并取出证书中的公钥，用该公钥对随机数进行加密，将加密后的结果发送到服务端。</p> <ul><li>服务端用收到的对称密钥加密一段握手信息，发送到客户端</li></ul> <p>服务端收到客户端发来的密钥，先用自己的私钥解密，解密成功后，用该对称密钥发送一段握手信息到客户端。客户端收到后，解密成功，至此，HTTPS 连接成功，后续的数据传输就会使用该对称密钥来进行加密。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/my-blog/zh/network/http.html" class="prev">
        http
      </a></span> <span class="next"><a href="/my-blog/zh/network/http-next.html">
        http-next
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-blog/assets/js/app.68e31997.js" defer></script><script src="/my-blog/assets/js/2.c20646db.js" defer></script><script src="/my-blog/assets/js/130.f37c3a38.js" defer></script>
  </body>
</html>
